<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Command.zig - source view</title>
    <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAgklEQVR4AWMYWuD7EllJIM4G4g4g5oIJ/odhOJ8wToOxSTXgNxDHoeiBMfA4+wGShjyYOCkG/IGqWQziEzYAoUAeiF9D5U+DxEg14DRU7jWIT5IBIOdCxf+A+CQZAAoopEB7QJwBCBwHiip8UYmRdrAlDpIMgApwQZNnNii5Dq0MBgCxxycBnwEd+wAAAABJRU5ErkJggg==">
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNTMgMTQwIj48ZyBmaWxsPSIjRjdBNDFEIj48Zz48cG9seWdvbiBwb2ludHM9IjQ2LDIyIDI4LDQ0IDE5LDMwIi8+PHBvbHlnb24gcG9pbnRzPSI0NiwyMiAzMywzMyAyOCw0NCAyMiw0NCAyMiw5NSAzMSw5NSAyMCwxMDAgMTIsMTE3IDAsMTE3IDAsMjIiIHNoYXBlLXJlbmRlcmluZz0iY3Jpc3BFZGdlcyIvPjxwb2x5Z29uIHBvaW50cz0iMzEsOTUgMTIsMTE3IDQsMTA2Ii8+PC9nPjxnPjxwb2x5Z29uIHBvaW50cz0iNTYsMjIgNjIsMzYgMzcsNDQiLz48cG9seWdvbiBwb2ludHM9IjU2LDIyIDExMSwyMiAxMTEsNDQgMzcsNDQgNTYsMzIiIHNoYXBlLXJlbmRlcmluZz0iY3Jpc3BFZGdlcyIvPjxwb2x5Z29uIHBvaW50cz0iMTE2LDk1IDk3LDExNyA5MCwxMDQiLz48cG9seWdvbiBwb2ludHM9IjExNiw5NSAxMDAsMTA0IDk3LDExNyA0MiwxMTcgNDIsOTUiIHNoYXBlLXJlbmRlcmluZz0iY3Jpc3BFZGdlcyIvPjxwb2x5Z29uIHBvaW50cz0iMTUwLDAgNTIsMTE3IDMsMTQwIDEwMSwyMiIvPjwvZz48Zz48cG9seWdvbiBwb2ludHM9IjE0MSwyMiAxNDAsNDAgMTIyLDQ1Ii8+PHBvbHlnb24gcG9pbnRzPSIxNTMsMjIgMTUzLDExNyAxMDYsMTE3IDEyMCwxMDUgMTI1LDk1IDEzMSw5NSAxMzEsNDUgMTIyLDQ1IDEzMiwzNiAxNDEsMjIiIHNoYXBlLXJlbmRlcmluZz0iY3Jpc3BFZGdlcyIvPjxwb2x5Z29uIHBvaW50cz0iMTI1LDk1IDEzMCwxMTAgMTA2LDExNyIvPjwvZz48L2c+PC9zdmc+">
    <style>
      body{
        font-family: system-ui, -apple-system, Roboto, "Segoe UI", sans-serif;
        margin: 0;
        line-height: 1.5;
      }

      pre > code {
        display: block;
        overflow: auto;
        line-height: normal;
        margin: 0em;
      }
      .tok-kw {
          color: #333;
          font-weight: bold;
      }
      .tok-str {
          color: #d14;
      }
      .tok-builtin {
          color: #005C7A;
      }
      .tok-comment {
          color: #545454;
          font-style: italic;
      }
      .tok-fn {
          color: #900;
          font-weight: bold;
      }
      .tok-null {
          color: #005C5C;
      }
      .tok-number {
          color: #005C5C;
      }
      .tok-type {
          color: #458;
          font-weight: bold;
      }
      pre {
        counter-reset: line;
      }
      pre .line:before {
        counter-increment: line;
        content: counter(line);
        display: inline-block;
        padding-right: 1em;
        width: 2em;
        text-align: right;
        color: #999;
      }
      
      .line {
        width: 100%;
        display: inline-block;
      }
      .line:target {
        border-top: 1px solid #ccc;
        border-bottom: 1px solid #ccc;
        background: #fafafa;
      }

      @media (prefers-color-scheme: dark) {
        body{
            background:#222;
            color: #ccc;
        }
        pre > code {
            color: #ccc;
            background: #222;
            border: unset;
        }
        .line:target {
            border-top: 1px solid #444;
            border-bottom: 1px solid #444;
            background: #333;
        }
        .tok-kw {
            color: #eee;
        }
        .tok-str {
            color: #2e5;
        }
        .tok-builtin {
            color: #ff894c;
        }
        .tok-comment {
            color: #aa7;
        }
        .tok-fn {
            color: #B1A0F8;
        }
        .tok-null {
            color: #ff8080;
        }
        .tok-number {
            color: #ff8080;
        }
        .tok-type {
            color: #68f;
        }
      }
    </style>
</head>
<body>
<pre><code><span class="line" id="L1"><span class="tok-comment">//! Container Argument for Sub Commands, Options, and Values.</span></span>
<span class="line" id="L2"><span class="tok-comment">//!</span></span>
<span class="line" id="L3"><span class="tok-comment">//! A Command may contain any mix of those Arguments or none at all if it's to be used as a standalone Command.</span></span>
<span class="line" id="L4"><span class="tok-comment">//!</span></span>
<span class="line" id="L5"><span class="tok-comment">//! End User Example:</span></span>
<span class="line" id="L6"><span class="tok-comment">//!</span></span>
<span class="line" id="L7"><span class="tok-comment">//! ```</span></span>
<span class="line" id="L8"><span class="tok-comment">//! # Standalone Command</span></span>
<span class="line" id="L9"><span class="tok-comment">//! myapp help</span></span>
<span class="line" id="L10"><span class="tok-comment">//!</span></span>
<span class="line" id="L11"><span class="tok-comment">//! # Command w/ Options and Values</span></span>
<span class="line" id="L12"><span class="tok-comment">//! myapp -d &quot;This Value belongs to the 'd' Option.&quot; --toggle &quot;This is a standalone Value.&quot;</span></span>
<span class="line" id="L13"><span class="tok-comment">//! </span></span>
<span class="line" id="L14"><span class="tok-comment">//! # Command w/ Sub Command</span></span>
<span class="line" id="L15"><span class="tok-comment">//! myapp --opt &quot;Option for 'myapp' Command.&quot; subcmd --subcmd_opt &quot;Option for 'subcmd' Sub Command.&quot;</span></span>
<span class="line" id="L16"><span class="tok-comment">//! ```</span></span>
<span class="line" id="L17"></span>
<span class="line" id="L18"><span class="tok-kw">const</span> std = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;std&quot;</span>);</span>
<span class="line" id="L19"><span class="tok-kw">const</span> ascii = std.ascii;</span>
<span class="line" id="L20"><span class="tok-kw">const</span> builtin = std.builtin;</span>
<span class="line" id="L21"><span class="tok-kw">const</span> fmt = std.fmt;</span>
<span class="line" id="L22"><span class="tok-kw">const</span> heap = std.heap;</span>
<span class="line" id="L23"><span class="tok-kw">const</span> json = std.json;</span>
<span class="line" id="L24"><span class="tok-kw">const</span> log = std.log;</span>
<span class="line" id="L25"><span class="tok-kw">const</span> mem = std.mem;</span>
<span class="line" id="L26"><span class="tok-kw">const</span> meta = std.meta;</span>
<span class="line" id="L27"><span class="tok-kw">const</span> sort = std.sort;</span>
<span class="line" id="L28"><span class="tok-kw">const</span> ComptimeStringMap = std.ComptimeStringMap;</span>
<span class="line" id="L29"><span class="tok-kw">const</span> StringHashMap = std.StringHashMap;</span>
<span class="line" id="L30"></span>
<span class="line" id="L31"><span class="tok-kw">const</span> toLower = ascii.toLower;</span>
<span class="line" id="L32"><span class="tok-kw">const</span> toUpper = ascii.toUpper;</span>
<span class="line" id="L33"></span>
<span class="line" id="L34"><span class="tok-kw">const</span> Option = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;Option.zig&quot;</span>);</span>
<span class="line" id="L35"><span class="tok-kw">const</span> Value = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;Value.zig&quot;</span>);</span>
<span class="line" id="L36"><span class="tok-kw">const</span> utils = <span class="tok-builtin">@import</span>(<span class="tok-str">&quot;utils.zig&quot;</span>);</span>
<span class="line" id="L37"></span>
<span class="line" id="L38"></span>
<span class="line" id="L39"><span class="tok-comment">/// Config for custom Command Types. </span></span>
<span class="line" id="L40"><span class="tok-kw">pub</span> <span class="tok-kw">const</span> Config = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L41">    <span class="tok-comment">/// Option Config for this Command Type.</span></span>
<span class="line" id="L42">    opt_config: Option.Config = .{},</span>
<span class="line" id="L43">    <span class="tok-comment">/// Value Config for this Command Type.</span></span>
<span class="line" id="L44">    val_config: Value.Config = .{},</span>
<span class="line" id="L45"></span>
<span class="line" id="L46">    <span class="tok-comment">/// The Global Help Prefix for all instances of this Command Type.</span></span>
<span class="line" id="L47">    <span class="tok-comment">/// This can be overwritten per instance using the `help_prefix` field. </span></span>
<span class="line" id="L48">    global_help_prefix: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L49"></span>
<span class="line" id="L50">    <span class="tok-comment">/// A custom Help function to override the default `help()` function globally for ALL Command instances of this custom Command Type.</span></span>
<span class="line" id="L51">    <span class="tok-comment">/// This function is 1st in precedence.</span></span>
<span class="line" id="L52">    <span class="tok-comment">///</span></span>
<span class="line" id="L53">    <span class="tok-comment">/// Function parameters:</span></span>
<span class="line" id="L54">    <span class="tok-comment">/// 1. CommandT (This should be the `self` parameter. As such it needs to match the Command Type the function is being called on.)</span></span>
<span class="line" id="L55">    <span class="tok-comment">/// 2. Writer (This is the Writer that will be written to.)</span></span>
<span class="line" id="L56">    <span class="tok-comment">/// 3. Allocator (This does not have to be used within in the function, but must be supported in case it's needed.)</span></span>
<span class="line" id="L57">    global_help_fn: ?*<span class="tok-kw">const</span> <span class="tok-kw">fn</span>(<span class="tok-kw">anytype</span>, <span class="tok-kw">anytype</span>, mem.Allocator)<span class="tok-type">anyerror</span>!<span class="tok-type">void</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L58">    <span class="tok-comment">/// A custom Usage function to override the default `usage()` function globally for ALL Command instances of this custom Command Type.</span></span>
<span class="line" id="L59">    <span class="tok-comment">/// This function is 1st in precedence.</span></span>
<span class="line" id="L60">    <span class="tok-comment">///</span></span>
<span class="line" id="L61">    <span class="tok-comment">/// Function parameters:</span></span>
<span class="line" id="L62">    <span class="tok-comment">/// 1. CommandT (This should be the `self` parameter. As such it needs to match the Command Type the function is being called on.)</span></span>
<span class="line" id="L63">    <span class="tok-comment">/// 2. Writer (This is the Writer that will be written to.)</span></span>
<span class="line" id="L64">    <span class="tok-comment">/// 3. Allocator (This does not have to be used within in the function, but must be supported in case it's needed.)</span></span>
<span class="line" id="L65">    global_usage_fn: ?*<span class="tok-kw">const</span> <span class="tok-kw">fn</span>(<span class="tok-kw">anytype</span>, <span class="tok-kw">anytype</span>, mem.Allocator)<span class="tok-type">anyerror</span>!<span class="tok-type">void</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L66"></span>
<span class="line" id="L67">    <span class="tok-comment">/// Indent string used for Usage/Help formatting.</span></span>
<span class="line" id="L68">    <span class="tok-comment">/// Note, this will be used as the default across all Argument Types,</span></span>
<span class="line" id="L69">    <span class="tok-comment">/// but it can be overriden in the Option and Value Configs.</span></span>
<span class="line" id="L70">    indent_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;    &quot;</span>,</span>
<span class="line" id="L71">    <span class="tok-comment">/// Group Title Format.</span></span>
<span class="line" id="L72">    <span class="tok-comment">/// Used for all Argument Type Groups.</span></span>
<span class="line" id="L73">    <span class="tok-comment">/// Must support the following format types in this order:</span></span>
<span class="line" id="L74">    <span class="tok-comment">/// 1. String (Indent)</span></span>
<span class="line" id="L75">    <span class="tok-comment">/// 2. String (Indent)</span></span>
<span class="line" id="L76">    <span class="tok-comment">/// 3. String (Group Title)</span></span>
<span class="line" id="L77">    group_title_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot; {s}|{s}|\n&quot;</span>,</span>
<span class="line" id="L78">    <span class="tok-comment">/// Group Separator string used for Help formatting.</span></span>
<span class="line" id="L79">    <span class="tok-comment">/// Used for all Argument Type Groups.</span></span>
<span class="line" id="L80">    <span class="tok-comment">/// Must support the following format types in this order:</span></span>
<span class="line" id="L81">    <span class="tok-comment">/// 1. String (Indent)</span></span>
<span class="line" id="L82">    <span class="tok-comment">/// 2. String (Indent)</span></span>
<span class="line" id="L83">    group_sep_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;{s}{s}\n&quot;</span>,</span>
<span class="line" id="L84">    <span class="tok-comment">/// Help Format for the displayed Command</span></span>
<span class="line" id="L85">    <span class="tok-comment">/// Must support the following format types in this order:</span></span>
<span class="line" id="L86">    <span class="tok-comment">/// 1. String (Indent)</span></span>
<span class="line" id="L87">    <span class="tok-comment">/// 2. String (Command Name)</span></span>
<span class="line" id="L88">    <span class="tok-comment">/// 3. String (Indent)</span></span>
<span class="line" id="L89">    <span class="tok-comment">/// 4. String (Command Description)</span></span>
<span class="line" id="L90">    help_header_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = </span>
<span class="line" id="L91">        <span class="tok-str">\\HELP:</span></span>

<span class="line" id="L92">        <span class="tok-str">\\{s}COMMAND: {s}</span></span>

<span class="line" id="L93">        <span class="tok-str">\\</span></span>

<span class="line" id="L94">        <span class="tok-str">\\{s}DESCRIPTION: {s}</span></span>

<span class="line" id="L95">        <span class="tok-str">\\</span></span>

<span class="line" id="L96">        <span class="tok-str">\\</span></span>

<span class="line" id="L97">    ,</span>
<span class="line" id="L98">    <span class="tok-comment">/// Alias List Format for the displayed Command</span></span>
<span class="line" id="L99">    <span class="tok-comment">/// Must support the following format types in this order:</span></span>
<span class="line" id="L100">    <span class="tok-comment">/// 1. String (Indent)</span></span>
<span class="line" id="L101">    <span class="tok-comment">/// 2. String (Aliases)</span></span>
<span class="line" id="L102">    <span class="tok-comment">/// Note, there will be curly-brackets `{}` surrounding the list due to how Zig handles printing `[]const []const u8`.</span></span>
<span class="line" id="L103">    cmd_alias_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = </span>
<span class="line" id="L104">        <span class="tok-str">\\{s}ALIAS(ES): {s}</span></span>

<span class="line" id="L105">        <span class="tok-str">\\</span></span>

<span class="line" id="L106">        <span class="tok-str">\\</span></span>

<span class="line" id="L107">    ,</span>
<span class="line" id="L108">    <span class="tok-comment">/// Usage Header Format</span></span>
<span class="line" id="L109">    <span class="tok-comment">/// Must support the following format types in this order:</span></span>
<span class="line" id="L110">    <span class="tok-comment">/// 1. String (Indent)</span></span>
<span class="line" id="L111">    <span class="tok-comment">/// 2. String (Command)</span></span>
<span class="line" id="L112">    usage_header_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = </span>
<span class="line" id="L113">        <span class="tok-str">\\USAGE:</span></span>

<span class="line" id="L114">        <span class="tok-str">\\{s}{s} </span></span>

<span class="line" id="L115">    ,</span>
<span class="line" id="L116">    <span class="tok-comment">/// Sub Commands Help Title Format</span></span>
<span class="line" id="L117">    <span class="tok-comment">/// Must support the following format types in this order:</span></span>
<span class="line" id="L118">    <span class="tok-comment">/// 1. String (Indent)</span></span>
<span class="line" id="L119">    subcmds_help_title_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;{s}SUBCOMMANDS:\n&quot;</span>,</span>
<span class="line" id="L120">    <span class="tok-comment">/// Options Help Title Format</span></span>
<span class="line" id="L121">    <span class="tok-comment">/// Must support the following format types in this order:</span></span>
<span class="line" id="L122">    <span class="tok-comment">/// 1. String (Indent)</span></span>
<span class="line" id="L123">    opts_help_title_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;{s}OPTIONS:\n&quot;</span>,</span>
<span class="line" id="L124">    <span class="tok-comment">/// Values Help Title Format</span></span>
<span class="line" id="L125">    <span class="tok-comment">/// Must support the following format types in this order:</span></span>
<span class="line" id="L126">    <span class="tok-comment">/// 1. String (Indent)</span></span>
<span class="line" id="L127">    vals_help_title_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;{s}VALUES:\n&quot;</span>,</span>
<span class="line" id="L128">    <span class="tok-comment">/// Sub Commands Help Format.</span></span>
<span class="line" id="L129">    <span class="tok-comment">/// Must support the following format types in this order:</span></span>
<span class="line" id="L130">    <span class="tok-comment">/// 1. String (Command Name)</span></span>
<span class="line" id="L131">    <span class="tok-comment">/// 2. String (Command Description)</span></span>
<span class="line" id="L132">    subcmds_help_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;{s}: {s}&quot;</span>,</span>
<span class="line" id="L133">    <span class="tok-comment">/// Sub Commands Usage Format.</span></span>
<span class="line" id="L134">    <span class="tok-comment">/// Must support the following format types in this order:</span></span>
<span class="line" id="L135">    <span class="tok-comment">/// 1. String (Command Name)</span></span>
<span class="line" id="L136">    subcmds_usage_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;{s}&quot;</span>, </span>
<span class="line" id="L137">    <span class="tok-comment">/// Sub Commands Alias List Format.</span></span>
<span class="line" id="L138">    <span class="tok-comment">/// Must support the following format types in this order:</span></span>
<span class="line" id="L139">    <span class="tok-comment">/// 1. String (Aliases)</span></span>
<span class="line" id="L140">    <span class="tok-comment">/// Note, there will be curly-brackets `{}` surrounding the list due to how Zig handles printing `[]const []const u8`.</span></span>
<span class="line" id="L141">    subcmd_alias_fmt: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;[alias(es): {s}]&quot;</span>,</span>
<span class="line" id="L142"></span>
<span class="line" id="L143">    <span class="tok-comment">/// The Default Max Number of Arguments for Commands, Options, and Values individually.</span></span>
<span class="line" id="L144">    <span class="tok-comment">/// This is used for both `init()` and `from()` but can be overwritten for the latter.</span></span>
<span class="line" id="L145">    max_args: <span class="tok-type">u8</span> = <span class="tok-number">25</span>,</span>
<span class="line" id="L146"></span>
<span class="line" id="L147">    <span class="tok-comment">/// During parsing, mandate that a Sub Command be used with a Command if one is available.</span></span>
<span class="line" id="L148">    <span class="tok-comment">/// This will not include Usage/Help Commands.</span></span>
<span class="line" id="L149">    <span class="tok-comment">/// This can be overwritten on individual Commands using the `Command.Custom.sub_cmds_mandatory` field.</span></span>
<span class="line" id="L150">    global_sub_cmds_mandatory: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L151">    <span class="tok-comment">/// During parsing, mandate that all Values for a Command must be filled, otherwise error out.</span></span>
<span class="line" id="L152">    <span class="tok-comment">/// This should generally be set to `true`. Prefer to use Options over Values for Arguments that are not mandatory.</span></span>
<span class="line" id="L153">    <span class="tok-comment">/// This can be overwritten on individual Commands using the `Command.Custom.vals_mandatory` field.</span></span>
<span class="line" id="L154">    global_vals_mandatory: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L155">    <span class="tok-comment">/// Allow Inheritable Options.</span></span>
<span class="line" id="L156">    <span class="tok-comment">/// These are Options with the `inheritable` flag set that can be accessed from sub-Commands of their Parent Command.</span></span>
<span class="line" id="L157">    global_allow_inheritable_opts: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L158">    <span class="tok-comment">/// During parsing, mandate that Command instances of this Command Type, and their aliases, must be used in a case-sensitive manner.</span></span>
<span class="line" id="L159">    <span class="tok-comment">/// This will also affect Command Validation, but will NOT affect Tab-Completion.</span></span>
<span class="line" id="L160">    global_case_sensitive: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L161"></span>
<span class="line" id="L162">    <span class="tok-comment">/// Return an instance of this Config with all `_fmt` fields set to `&quot;&quot;`.</span></span>
<span class="line" id="L163">    <span class="tok-comment">/// This is useful for trimming down the binary size if Cova's Usage/Help functionality isn't being used.</span></span>
<span class="line" id="L164">    <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">noFormats</span>() <span class="tok-builtin">@This</span>() {</span>
<span class="line" id="L165">        <span class="tok-kw">var</span> config: <span class="tok-builtin">@This</span>() = .{};</span>
<span class="line" id="L166">        config.opt_config = Option.Config.noFormats();</span>
<span class="line" id="L167">        config.val_config = Value.Config.noFormats();</span>
<span class="line" id="L168">        <span class="tok-kw">inline</span> <span class="tok-kw">for</span> (meta.fields(<span class="tok-builtin">@This</span>())) |field| {</span>
<span class="line" id="L169">            <span class="tok-kw">if</span> (mem.endsWith(<span class="tok-type">u8</span>, field.name, <span class="tok-str">&quot;_fmt&quot;</span>)) <span class="tok-builtin">@field</span>(config, field.name) = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L170">        }</span>
<span class="line" id="L171">        <span class="tok-kw">return</span> config;</span>
<span class="line" id="L172">    }</span>
<span class="line" id="L173">};</span>
<span class="line" id="L174"></span>
<span class="line" id="L175"><span class="tok-comment">/// Create a Command Type with the Base (default) configuration.</span></span>
<span class="line" id="L176"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">Base</span>() <span class="tok-type">type</span> { <span class="tok-kw">return</span> Custom(.{}); }</span>
<span class="line" id="L177"></span>
<span class="line" id="L178"><span class="tok-comment">/// Create a Custom Command Type from the provided Config (`config`).</span></span>
<span class="line" id="L179"><span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">Custom</span>(<span class="tok-kw">comptime</span> config: Config) <span class="tok-type">type</span> {</span>
<span class="line" id="L180">    <span class="tok-kw">return</span> <span class="tok-kw">struct</span> {</span>
<span class="line" id="L181">        <span class="tok-comment">/// Value Config Setup</span></span>
<span class="line" id="L182">        <span class="tok-kw">const</span> val_config = valConfig: {</span>
<span class="line" id="L183">            <span class="tok-kw">var</span> setup_val_config = config.val_config;</span>
<span class="line" id="L184">            setup_val_config.CommandT = <span class="tok-builtin">@This</span>();</span>
<span class="line" id="L185">            setup_val_config.indent_fmt = setup_val_config.indent_fmt <span class="tok-kw">orelse</span> config.indent_fmt;</span>
<span class="line" id="L186">            <span class="tok-kw">break</span> :valConfig setup_val_config;</span>
<span class="line" id="L187">        };</span>
<span class="line" id="L188">        <span class="tok-comment">/// Option Config Setup</span></span>
<span class="line" id="L189">        <span class="tok-kw">const</span> opt_config = optConfig: {</span>
<span class="line" id="L190">            <span class="tok-kw">var</span> setup_opt_config = config.opt_config;</span>
<span class="line" id="L191">            setup_opt_config.CommandT = <span class="tok-builtin">@This</span>();</span>
<span class="line" id="L192">            setup_opt_config.val_config = val_config;</span>
<span class="line" id="L193">            setup_opt_config.indent_fmt = setup_opt_config.indent_fmt <span class="tok-kw">orelse</span> config.indent_fmt;</span>
<span class="line" id="L194">            <span class="tok-kw">break</span> :optConfig setup_opt_config;</span>
<span class="line" id="L195">        };</span>
<span class="line" id="L196">        <span class="tok-comment">/// The Custom Option type to be used by this Custom Command type.</span></span>
<span class="line" id="L197">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> OptionT = Option.Custom(opt_config);</span>
<span class="line" id="L198">        <span class="tok-comment">/// The Custom Value type to be used by this Custom Command type.</span></span>
<span class="line" id="L199">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> ValueT = Value.Custom(val_config);</span>
<span class="line" id="L200"></span>
<span class="line" id="L201">        <span class="tok-comment">/// Custom Help Function.</span></span>
<span class="line" id="L202">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L203">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> global_help_fn = config.global_help_fn;</span>
<span class="line" id="L204">        <span class="tok-comment">/// Custom Usage Function.</span></span>
<span class="line" id="L205">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L206">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> global_usage_fn = config.global_usage_fn;</span>
<span class="line" id="L207"></span>
<span class="line" id="L208">        <span class="tok-comment">/// Group Title Format.</span></span>
<span class="line" id="L209">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L210">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> group_title_fmt = config.group_title_fmt;</span>
<span class="line" id="L211">        <span class="tok-comment">/// Group Separator Format.</span></span>
<span class="line" id="L212">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L213">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> group_sep_fmt = config.group_sep_fmt;</span>
<span class="line" id="L214">        <span class="tok-comment">/// Indent Format.</span></span>
<span class="line" id="L215">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L216">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> indent_fmt = config.indent_fmt;</span>
<span class="line" id="L217">        <span class="tok-comment">/// Help Header Format.</span></span>
<span class="line" id="L218">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L219">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> help_header_fmt = config.help_header_fmt;</span>
<span class="line" id="L220">        <span class="tok-comment">/// Alias List Header Format.</span></span>
<span class="line" id="L221">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L222">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> cmd_alias_fmt = config.cmd_alias_fmt;</span>
<span class="line" id="L223">        <span class="tok-comment">/// Usage Header Format.</span></span>
<span class="line" id="L224">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L225">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> usage_header_fmt = config.usage_header_fmt;</span>
<span class="line" id="L226">        <span class="tok-comment">/// Sub Commands Help Title Format.</span></span>
<span class="line" id="L227">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L228">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> subcmds_help_title_fmt = config.subcmds_help_title_fmt;</span>
<span class="line" id="L229">        <span class="tok-comment">/// Options Help Title Format.</span></span>
<span class="line" id="L230">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L231">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> opts_help_title_fmt = config.opts_help_title_fmt;</span>
<span class="line" id="L232">        <span class="tok-comment">/// Value Help Title Format.</span></span>
<span class="line" id="L233">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L234">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> vals_help_title_fmt = config.vals_help_title_fmt;</span>
<span class="line" id="L235">        <span class="tok-comment">/// Sub Commands Help Format.</span></span>
<span class="line" id="L236">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L237">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> subcmds_help_fmt = config.subcmds_help_fmt;</span>
<span class="line" id="L238">        <span class="tok-comment">/// Sub Commands Usage Format.</span></span>
<span class="line" id="L239">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L240">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> subcmds_usage_fmt = config.subcmds_usage_fmt;</span>
<span class="line" id="L241">        <span class="tok-comment">/// Sub Commands Alias List Format.</span></span>
<span class="line" id="L242">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L243">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> subcmd_alias_fmt = config.subcmd_alias_fmt;</span>
<span class="line" id="L244">        <span class="tok-comment">/// Global Help Prefix.</span></span>
<span class="line" id="L245">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L246">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> global_help_prefix = config.global_help_prefix;</span>
<span class="line" id="L247">        <span class="tok-comment">/// Max Args.</span></span>
<span class="line" id="L248">        <span class="tok-comment">/// Check (`Command.Config`) for details.</span></span>
<span class="line" id="L249">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> max_args = config.max_args;</span>
<span class="line" id="L250"></span>
<span class="line" id="L251"></span>
<span class="line" id="L252">        <span class="tok-comment">/// The Root Allocator for this Command.</span></span>
<span class="line" id="L253">        <span class="tok-comment">/// This is the Allocator provided to `init()`.</span></span>
<span class="line" id="L254">        <span class="tok-comment">/// </span></span>
<span class="line" id="L255">        <span class="tok-comment">/// **Internal Use.**</span></span>
<span class="line" id="L256">        _root_alloc: ?mem.Allocator = <span class="tok-null">null</span>,</span>
<span class="line" id="L257">        <span class="tok-comment">/// The Arena Allocator for this Command.</span></span>
<span class="line" id="L258">        <span class="tok-comment">/// This is created by wrapping the Root Allocator provided to `init()`.</span></span>
<span class="line" id="L259">        <span class="tok-comment">/// </span></span>
<span class="line" id="L260">        <span class="tok-comment">/// **Internal Use.**</span></span>
<span class="line" id="L261">        _arena: ?heap.ArenaAllocator = <span class="tok-null">null</span>,</span>
<span class="line" id="L262">        <span class="tok-comment">/// The Allocator for this Command.</span></span>
<span class="line" id="L263">        <span class="tok-comment">/// This is set using `init()`.</span></span>
<span class="line" id="L264">        <span class="tok-comment">///</span></span>
<span class="line" id="L265">        <span class="tok-comment">/// **Internal Use.**</span></span>
<span class="line" id="L266">        _alloc: ?mem.Allocator = <span class="tok-null">null</span>,</span>
<span class="line" id="L267"></span>
<span class="line" id="L268">        <span class="tok-comment">/// Command Groups.</span></span>
<span class="line" id="L269">        <span class="tok-comment">/// These groups are used for organizing sub-Commands in Help messages and other Generated docs.</span></span>
<span class="line" id="L270">        cmd_groups: ?[]<span class="tok-kw">const</span> []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L271">        <span class="tok-comment">/// Command Group of this Command.</span></span>
<span class="line" id="L272">        <span class="tok-comment">/// This must line up with one of the Command Groups in the `cmd_groups` of the parent Command or it will be ignored.</span></span>
<span class="line" id="L273">        <span class="tok-comment">/// This can be Validated using `ValidateConfig.check_arg_groups`.</span></span>
<span class="line" id="L274">        cmd_group: ?[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L275">        <span class="tok-comment">/// Option Groups.</span></span>
<span class="line" id="L276">        <span class="tok-comment">/// These groups are used for organizing Options in Help messages and other Generated docs.</span></span>
<span class="line" id="L277">        opt_groups: ?[]<span class="tok-kw">const</span> []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L278">        <span class="tok-comment">/// Value Groups.</span></span>
<span class="line" id="L279">        <span class="tok-comment">/// These groups are used for organizing Values in Help messages and other Generated docs.</span></span>
<span class="line" id="L280">        val_groups: ?[]<span class="tok-kw">const</span> []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L281"></span>
<span class="line" id="L282">        <span class="tok-comment">/// The Argument Index of this Command which is determined during parsing.</span></span>
<span class="line" id="L283">        <span class="tok-comment">///</span></span>
<span class="line" id="L284">        <span class="tok-comment">/// *This should be Read-Only for library users.*</span></span>
<span class="line" id="L285">        arg_idx: ?<span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L286"></span>
<span class="line" id="L287">        <span class="tok-comment">/// The list of Sub Commands this Command can take.</span></span>
<span class="line" id="L288">        sub_cmds: ?[]<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>() = <span class="tok-null">null</span>,</span>
<span class="line" id="L289">        <span class="tok-comment">//sub_cmds: if (@inComptime()) ?[]const @This() else ?[]@This() = null,</span>
</span>
<span class="line" id="L290">        <span class="tok-comment">/// The Sub Command assigned to this Command during Parsing, if any.</span></span>
<span class="line" id="L291">        <span class="tok-comment">///</span></span>
<span class="line" id="L292">        <span class="tok-comment">/// *This should be Read-Only for library users.*</span></span>
<span class="line" id="L293">        sub_cmd: ?*<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>() = <span class="tok-null">null</span>,</span>
<span class="line" id="L294">        <span class="tok-comment">//sub_cmd: ?*@This() = null,</span>
</span>
<span class="line" id="L295">        <span class="tok-comment">/// The Parent Command of this Command.</span></span>
<span class="line" id="L296">        <span class="tok-comment">/// This will be filled in during Initialization.</span></span>
<span class="line" id="L297">        parent_cmd: ?*<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>() = <span class="tok-null">null</span>,</span>
<span class="line" id="L298"></span>
<span class="line" id="L299">        <span class="tok-comment">/// The list of Options this Command can take.</span></span>
<span class="line" id="L300">        opts: ?[]<span class="tok-kw">const</span> OptionT = <span class="tok-null">null</span>,</span>
<span class="line" id="L301">        <span class="tok-comment">/// The list of Values this Command can take.</span></span>
<span class="line" id="L302">        vals: ?[]<span class="tok-kw">const</span> ValueT = <span class="tok-null">null</span>,</span>
<span class="line" id="L303"></span>
<span class="line" id="L304">        <span class="tok-comment">/// The Name of this Command for user identification and Usage/Help messages.</span></span>
<span class="line" id="L305">        name: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>,</span>
<span class="line" id="L306">        <span class="tok-comment">/// A list of Alias Names for this Command that can be used in place of `name`.</span></span>
<span class="line" id="L307">        alias_names: ?[]<span class="tok-kw">const</span> []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L308">        <span class="tok-comment">/// The Prefix message used immediately before a Usage/Help message is displayed.</span></span>
<span class="line" id="L309">        help_prefix: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = global_help_prefix,</span>
<span class="line" id="L310">        <span class="tok-comment">/// The Description of this Command for Usage/Help messages.</span></span>
<span class="line" id="L311">        description: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L312">        <span class="tok-comment">/// An optional Verbose Description for this Command.</span></span>
<span class="line" id="L313">        <span class="tok-comment">//verbose_description: ?[]const u8 = null,</span>
</span>
<span class="line" id="L314">        <span class="tok-comment">/// Hide thie Command from Usage/Help messages.</span></span>
<span class="line" id="L315">        hidden: <span class="tok-type">bool</span> = <span class="tok-null">false</span>,</span>
<span class="line" id="L316"></span>
<span class="line" id="L317">        <span class="tok-comment">/// During parsing, mandate that a Sub Command be used with this Command if one is available.</span></span>
<span class="line" id="L318">        <span class="tok-comment">/// Note, this will not include Usage/Help Commands.</span></span>
<span class="line" id="L319">        sub_cmds_mandatory: <span class="tok-type">bool</span> = config.global_sub_cmds_mandatory,</span>
<span class="line" id="L320">        <span class="tok-comment">/// During parsing, mandate that Options in the provided Option Groups be used.</span></span>
<span class="line" id="L321">        <span class="tok-comment">/// This is a SUBSET of the `opt_groups`.</span></span>
<span class="line" id="L322">        mandatory_opt_groups: ?[]<span class="tok-kw">const</span> []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L323">        <span class="tok-comment">/// During parsing, mandate that all Values for this Command must be filled, otherwise error out.</span></span>
<span class="line" id="L324">        <span class="tok-comment">/// This should generally be set to `true`. Prefer to use Options over Values for Arguments that are not mandatory.</span></span>
<span class="line" id="L325">        vals_mandatory: <span class="tok-type">bool</span> = config.global_vals_mandatory,</span>
<span class="line" id="L326">        <span class="tok-comment">/// Allows this Command to inherit Options </span></span>
<span class="line" id="L327">        allow_inheritable_opts: <span class="tok-type">bool</span> = config.global_allow_inheritable_opts,</span>
<span class="line" id="L328">        <span class="tok-comment">/// During parsing, mandate that THIS Command, and its aliases, must be used in a case-sensitive manner.</span></span>
<span class="line" id="L329">        <span class="tok-comment">/// This will NOT affect Command Validation nor Tab-Completion.</span></span>
<span class="line" id="L330">        case_sensitive: <span class="tok-type">bool</span> = config.global_case_sensitive,</span>
<span class="line" id="L331"></span>
<span class="line" id="L332">        <span class="tok-comment">/// Set the Argument Index of this Command.</span></span>
<span class="line" id="L333">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setArgIdx</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), arg_idx: <span class="tok-type">u8</span>) <span class="tok-type">void</span> {</span>
<span class="line" id="L334">            <span class="tok-builtin">@constCast</span>(self).*.arg_idx = arg_idx;</span>
<span class="line" id="L335">        }</span>
<span class="line" id="L336"></span>
<span class="line" id="L337">        <span class="tok-comment">/// Set the active Sub Command for this Command.</span></span>
<span class="line" id="L338">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">setSubCmd</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), set_cmd: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>()) <span class="tok-type">void</span> {</span>
<span class="line" id="L339">            <span class="tok-builtin">@constCast</span>(self).*.sub_cmd = set_cmd;</span>
<span class="line" id="L340">        }</span>
<span class="line" id="L341">        <span class="tok-comment">//pub fn setSubCmd(self: *@This(), set_cmd: *@This()) void {</span>
</span>
<span class="line" id="L342">        <span class="tok-comment">//    self.sub_cmd = set_cmd;</span>
</span>
<span class="line" id="L343">        <span class="tok-comment">//}</span>
</span>
<span class="line" id="L344">        <span class="tok-comment">/// Get a reference to the Sub Command of this Command that matches the provided Name (`cmd_name`).</span></span>
<span class="line" id="L345">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getSubCmd</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), cmd_name: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) ?*<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>() {</span>
<span class="line" id="L346">            <span class="tok-kw">if</span> (self.sub_cmds == <span class="tok-null">null</span>) <span class="tok-kw">return</span> <span class="tok-null">null</span>;</span>
<span class="line" id="L347">            <span class="tok-kw">for</span> (self.sub_cmds.?[<span class="tok-number">0</span>..]) |*cmd| <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, cmd.name, cmd_name)) <span class="tok-kw">return</span> cmd;</span>
<span class="line" id="L348">            <span class="tok-kw">return</span> <span class="tok-null">null</span>;</span>
<span class="line" id="L349">        }</span>
<span class="line" id="L350">        <span class="tok-comment">/// Check if the active Sub Command of this Command has the provided Name (`cmd_name`).</span></span>
<span class="line" id="L351">        <span class="tok-comment">/// This is useful for analyzing Commands that DO NOT have Sub Commands that need to be subsequently analyzed.</span></span>
<span class="line" id="L352">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">checkSubCmd</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), cmd_name: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <span class="tok-type">bool</span> {</span>
<span class="line" id="L353">            <span class="tok-kw">return</span> <span class="tok-kw">if</span> (self.sub_cmd) |cmd| mem.eql(<span class="tok-type">u8</span>, cmd.name, cmd_name) <span class="tok-kw">else</span> <span class="tok-null">false</span>;</span>
<span class="line" id="L354">        }</span>
<span class="line" id="L355">        <span class="tok-comment">/// Returns the active Sub Command of this Command if it matches the provided Name (`cmd_name`). </span></span>
<span class="line" id="L356">        <span class="tok-comment">/// This is useful for analyzing Commands that DO have Sub Commands that need to be subsequently analyzed.</span></span>
<span class="line" id="L357">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">matchSubCmd</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), cmd_name: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) ?*<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>() {</span>
<span class="line" id="L358">            <span class="tok-kw">return</span> <span class="tok-kw">if</span> (self.checkSubCmd(cmd_name)) self.sub_cmd.? <span class="tok-kw">else</span> <span class="tok-null">null</span>;</span>
<span class="line" id="L359">        }</span>
<span class="line" id="L360"></span>
<span class="line" id="L361">        <span class="tok-comment">/// Config for Getting Options and Values.</span></span>
<span class="line" id="L362">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> GetConfig = <span class="tok-kw">struct</span>{</span>
<span class="line" id="L363">            <span class="tok-comment">/// An optional Argument Group to filter the returned Options or Values.</span></span>
<span class="line" id="L364">            arg_group: ?[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L365">        };</span>
<span class="line" id="L366"></span>
<span class="line" id="L367">        <span class="tok-comment">/// Gets a StringHashMap of this Command's Options using its initialization Allocator.</span></span>
<span class="line" id="L368">        <span class="tok-comment">/// Memory is owned by this Command's Allocator. Look at the `...Alloc()` version of this method to use a different Allocator.</span></span>
<span class="line" id="L369">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getOpts</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), get_config: GetConfig) !StringHashMap(OptionT) {</span>
<span class="line" id="L370">            <span class="tok-kw">const</span> alloc = self._alloc <span class="tok-kw">orelse</span> <span class="tok-kw">return</span> <span class="tok-kw">error</span>.CommandNotInitialized;</span>
<span class="line" id="L371">            <span class="tok-kw">return</span> self.getOptsAlloc(alloc, get_config);</span>
<span class="line" id="L372">        }</span>
<span class="line" id="L373">        <span class="tok-comment">/// Gets a StringHashMap of this Command's Options using the provided Allocator (`alloc`).</span></span>
<span class="line" id="L374">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getOptsAlloc</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), alloc: mem.Allocator, get_config: GetConfig) !StringHashMap(OptionT) {</span>
<span class="line" id="L375">            <span class="tok-kw">if</span> (self.opts == <span class="tok-null">null</span>) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.NoOptionsInCommand;</span>
<span class="line" id="L376">            <span class="tok-kw">var</span> map = StringHashMap(OptionT).init(alloc);</span>
<span class="line" id="L377">            <span class="tok-kw">for</span> (self.opts.?) |opt| { </span>
<span class="line" id="L378">                checkGroup: {</span>
<span class="line" id="L379">                    <span class="tok-kw">const</span> conf_group = get_config.arg_group <span class="tok-kw">orelse</span> <span class="tok-kw">break</span> :checkGroup;</span>
<span class="line" id="L380">                    <span class="tok-kw">const</span> opt_group = opt.opt_group <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>;</span>
<span class="line" id="L381">                    <span class="tok-kw">if</span> (!mem.eql(<span class="tok-type">u8</span>, conf_group, opt_group)) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L382">                }</span>
<span class="line" id="L383">                <span class="tok-kw">try</span> map.put(opt.name, opt); </span>
<span class="line" id="L384">            }</span>
<span class="line" id="L385">            <span class="tok-kw">return</span> map;</span>
<span class="line" id="L386">        }</span>
<span class="line" id="L387">        <span class="tok-comment">/// Config for Checking or Matching multiple Options from this Command.</span></span>
<span class="line" id="L388">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> OptionsCheckConfig = <span class="tok-kw">struct</span>{</span>
<span class="line" id="L389">            <span class="tok-comment">/// The type of Boolean Logic to be used when checking or matching Options.</span></span>
<span class="line" id="L390">            logic: CheckLogic = .OR,</span>
<span class="line" id="L391">            <span class="tok-comment">/// The maximum number of Options allowed for XOR Logic.</span></span>
<span class="line" id="L392">            <span class="tok-comment">/// This technically breaks from actual XOR Logic, but allows a specific number of Options to be checked or matched.</span></span>
<span class="line" id="L393">            xor_max: <span class="tok-type">u8</span> = <span class="tok-number">1</span>,</span>
<span class="line" id="L394">            <span class="tok-comment">/// An optional Option Group to filter Checks/Matches.</span></span>
<span class="line" id="L395">            opt_group: ?[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L396"></span>
<span class="line" id="L397">            <span class="tok-comment">/// Boolean Logic types for checking/matching Options.</span></span>
<span class="line" id="L398">            <span class="tok-kw">pub</span> <span class="tok-kw">const</span> CheckLogic = <span class="tok-kw">enum</span>{</span>
<span class="line" id="L399">                <span class="tok-comment">/// All Options from the provided list must be set.</span></span>
<span class="line" id="L400">                AND,</span>
<span class="line" id="L401">                <span class="tok-comment">/// At least one Option from the provided list must be set.</span></span>
<span class="line" id="L402">                OR,</span>
<span class="line" id="L403">                <span class="tok-comment">/// Exactly `xor_mx` number of Options from the provided list must be set.</span></span>
<span class="line" id="L404">                XOR,</span>
<span class="line" id="L405">            };</span>
<span class="line" id="L406">        };</span>
<span class="line" id="L407">        <span class="tok-comment">/// Check if certain Options (`opt_names`) of this Command have been set using the provided OptionsCheckConfig (`check_config`).</span></span>
<span class="line" id="L408">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">checkOpts</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), opt_names: []<span class="tok-kw">const</span> []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, check_config: OptionsCheckConfig) <span class="tok-type">bool</span> {</span>
<span class="line" id="L409">            <span class="tok-kw">const</span> cmd_opts = self.opts <span class="tok-kw">orelse</span> <span class="tok-kw">return</span> <span class="tok-null">false</span>;</span>
<span class="line" id="L410">            <span class="tok-kw">var</span> logic_flag = <span class="tok-null">false</span>;</span>
<span class="line" id="L411">            <span class="tok-kw">var</span> opts_count: <span class="tok-type">u8</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L412">            <span class="tok-kw">for</span> (cmd_opts) |opt| {</span>
<span class="line" id="L413">                checkGroup: {</span>
<span class="line" id="L414">                    <span class="tok-kw">const</span> conf_group = check_config.opt_group <span class="tok-kw">orelse</span> <span class="tok-kw">break</span> :checkGroup;</span>
<span class="line" id="L415">                    <span class="tok-kw">const</span> opt_group = opt.opt_group <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>;</span>
<span class="line" id="L416">                    <span class="tok-kw">if</span> (!mem.eql(<span class="tok-type">u8</span>, conf_group, opt_group)) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L417">                }</span>
<span class="line" id="L418">                _ = utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, opt_names, opt.name) <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>;</span>
<span class="line" id="L419">                <span class="tok-kw">if</span> (!opt.val.isSet()) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L420">                opts_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L421">                <span class="tok-kw">switch</span> (check_config.logic) {</span>
<span class="line" id="L422">                    .AND =&gt; {</span>
<span class="line" id="L423">                        <span class="tok-kw">if</span> (opts_count == opt_names.len) {</span>
<span class="line" id="L424">                            logic_flag = <span class="tok-null">true</span>;</span>
<span class="line" id="L425">                            <span class="tok-kw">break</span>;   </span>
<span class="line" id="L426">                        }    </span>
<span class="line" id="L427">                    },</span>
<span class="line" id="L428">                    .OR =&gt; logic_flag = <span class="tok-null">true</span>,</span>
<span class="line" id="L429">                    .XOR =&gt; {</span>
<span class="line" id="L430">                        <span class="tok-kw">if</span> (opts_count &gt; check_config.xor_max) {</span>
<span class="line" id="L431">                            logic_flag = <span class="tok-null">false</span>;</span>
<span class="line" id="L432">                            <span class="tok-kw">break</span>;</span>
<span class="line" id="L433">                        }</span>
<span class="line" id="L434">                        logic_flag = <span class="tok-null">true</span>;</span>
<span class="line" id="L435">                    },</span>
<span class="line" id="L436">                }</span>
<span class="line" id="L437">            }</span>
<span class="line" id="L438">            <span class="tok-kw">return</span> logic_flag;</span>
<span class="line" id="L439">        }</span>
<span class="line" id="L440">        <span class="tok-comment">/// Returns a slice of Options `[]OptionT` Matching the given Options list (`opt_names`) and rules provided in the OptionCheckConfig (`check_config`).</span></span>
<span class="line" id="L441">        <span class="tok-comment">/// This implementation uses this Command's initialization Allocator to allocate the OptionT slice.</span></span>
<span class="line" id="L442">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">matchOpts</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), opt_names: []<span class="tok-kw">const</span> []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, check_config: OptionsCheckConfig) ![]OptionT {</span>
<span class="line" id="L443">            <span class="tok-kw">const</span> alloc = self._alloc <span class="tok-kw">orelse</span> <span class="tok-kw">return</span> <span class="tok-kw">error</span>.CommandNotInitialized;</span>
<span class="line" id="L444">            <span class="tok-kw">return</span> self.matchOptsAlloc(opt_names, alloc, check_config);</span>
<span class="line" id="L445">        }</span>
<span class="line" id="L446">        <span class="tok-comment">/// Returns a slice of Options `[]OptionT` Matching the given Options list (`opt_names`) and rules provided in the OptionCheckConfig (`check_config`).</span></span>
<span class="line" id="L447">        <span class="tok-comment">/// This implementation uses the provided Allocator (`alloc`) to allocate the OptionT slice.</span></span>
<span class="line" id="L448">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">matchOptsAlloc</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), opt_names: []<span class="tok-kw">const</span> []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, alloc: mem.Allocator, check_config: OptionsCheckConfig) ![]OptionT {</span>
<span class="line" id="L449">            <span class="tok-kw">const</span> cmd_opts = self.opts <span class="tok-kw">orelse</span> <span class="tok-kw">return</span> <span class="tok-kw">error</span>.NoOptionsInCommand;</span>
<span class="line" id="L450">            <span class="tok-kw">var</span> opts_list = std.ArrayList(OptionT).init(alloc);</span>
<span class="line" id="L451">            <span class="tok-kw">errdefer</span> opts_list.deinit();</span>
<span class="line" id="L452">            <span class="tok-kw">var</span> logic_flag = <span class="tok-null">false</span>;</span>
<span class="line" id="L453">            <span class="tok-kw">for</span> (cmd_opts) |opt| {</span>
<span class="line" id="L454">                checkGroup: {</span>
<span class="line" id="L455">                    <span class="tok-kw">const</span> conf_group = check_config.opt_group <span class="tok-kw">orelse</span> <span class="tok-kw">break</span> :checkGroup;</span>
<span class="line" id="L456">                    <span class="tok-kw">const</span> opt_group = opt.opt_group <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>;</span>
<span class="line" id="L457">                    <span class="tok-kw">if</span> (!mem.eql(<span class="tok-type">u8</span>, conf_group, opt_group)) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L458">                }</span>
<span class="line" id="L459">                _ = utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, opt_names, opt.name) <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>;</span>
<span class="line" id="L460">                <span class="tok-kw">if</span> (!opt.val.isSet()) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L461">                <span class="tok-kw">try</span> opts_list.append(opt);</span>
<span class="line" id="L462">                <span class="tok-kw">switch</span> (check_config.logic) {</span>
<span class="line" id="L463">                    .AND =&gt; {</span>
<span class="line" id="L464">                        <span class="tok-kw">if</span> (opts_list.items.len == opt_names.len) {</span>
<span class="line" id="L465">                            logic_flag = <span class="tok-null">true</span>;</span>
<span class="line" id="L466">                            <span class="tok-kw">break</span>;</span>
<span class="line" id="L467">                        }</span>
<span class="line" id="L468">                    },</span>
<span class="line" id="L469">                    .OR =&gt; logic_flag = <span class="tok-null">true</span>,</span>
<span class="line" id="L470">                    .XOR =&gt; {</span>
<span class="line" id="L471">                        <span class="tok-kw">if</span> (opts_list.items.len &gt; check_config.xor_max) {</span>
<span class="line" id="L472">                            logic_flag = <span class="tok-null">false</span>;</span>
<span class="line" id="L473">                            <span class="tok-kw">break</span>;</span>
<span class="line" id="L474">                        }</span>
<span class="line" id="L475">                        logic_flag = <span class="tok-null">true</span>;</span>
<span class="line" id="L476">                    },</span>
<span class="line" id="L477">                }</span>
<span class="line" id="L478">            }</span>
<span class="line" id="L479">            <span class="tok-kw">if</span> (!logic_flag) {</span>
<span class="line" id="L480">                <span class="tok-kw">return</span> <span class="tok-kw">switch</span> (check_config.logic) {</span>
<span class="line" id="L481">                    .AND =&gt; <span class="tok-kw">error</span>.MatchOptionLogicFailAND,</span>
<span class="line" id="L482">                    .OR =&gt; <span class="tok-kw">error</span>.MatchOptionLogicFailOR,</span>
<span class="line" id="L483">                    .XOR =&gt; <span class="tok-kw">error</span>.MatchOptionLogicFailXOR,</span>
<span class="line" id="L484">                };</span>
<span class="line" id="L485">            }</span>
<span class="line" id="L486">            <span class="tok-kw">return</span> <span class="tok-kw">try</span> opts_list.toOwnedSlice();</span>
<span class="line" id="L487">        }</span>
<span class="line" id="L488">        <span class="tok-comment">/// Gets a slice of all Inheritable Options from this Command and recursively upward through all Parent Commands using the provided Allocator (`alloc`).</span></span>
<span class="line" id="L489">        <span class="tok-comment">/// Memory is owned by this Command's Allocator. Look at the `...Alloc()` version of this method to use a different Allocator.</span></span>
<span class="line" id="L490">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">inheritableOpts</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>()) ![]OptionT {</span>
<span class="line" id="L491">            <span class="tok-kw">const</span> alloc = self._alloc <span class="tok-kw">orelse</span> <span class="tok-kw">return</span> <span class="tok-kw">error</span>.CommandNotInitialized;</span>
<span class="line" id="L492">            <span class="tok-kw">return</span> self.inheritableOptsAlloc(alloc);</span>
<span class="line" id="L493">        }</span>
<span class="line" id="L494">        <span class="tok-comment">/// Gets a slice of all Inheritable Options from this Command and recursively upward through all Parent Commands.</span></span>
<span class="line" id="L495">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">inheritableOptsAlloc</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), alloc: mem.Allocator) ![]OptionT {</span>
<span class="line" id="L496">            <span class="tok-kw">var</span> opts_list = std.ArrayList(OptionT).init(alloc);</span>
<span class="line" id="L497">            <span class="tok-kw">if</span> (self.opts) |opts| {</span>
<span class="line" id="L498">                <span class="tok-kw">for</span> (opts) |opt| {</span>
<span class="line" id="L499">                    <span class="tok-kw">if</span> (opt.inheritable) <span class="tok-kw">try</span> opts_list.append(opt);</span>
<span class="line" id="L500">                }</span>
<span class="line" id="L501">            }</span>
<span class="line" id="L502">            <span class="tok-kw">if</span> (self.parent_cmd) |parent| <span class="tok-kw">try</span> (opts_list.appendSlice(<span class="tok-kw">try</span> parent.inheritableOptsAlloc(alloc)));</span>
<span class="line" id="L503">            <span class="tok-kw">return</span> <span class="tok-kw">try</span> opts_list.toOwnedSlice();</span>
<span class="line" id="L504">        }</span>
<span class="line" id="L505"></span>
<span class="line" id="L506">        <span class="tok-comment">/// Gets a StringHashMap of this Command's Values using its initialization Allocator.</span></span>
<span class="line" id="L507">        <span class="tok-comment">/// Memory is owned by this Command's Allocator. Look at the `...Alloc()` version of this method to use a different Allocator.</span></span>
<span class="line" id="L508">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getVals</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), get_config: GetConfig) !StringHashMap(ValueT) {</span>
<span class="line" id="L509">            <span class="tok-kw">const</span> alloc = self._alloc <span class="tok-kw">orelse</span> <span class="tok-kw">return</span> <span class="tok-kw">error</span>.CommandNotInitialized;</span>
<span class="line" id="L510">            <span class="tok-kw">return</span> self.getValsAlloc(alloc, get_config);</span>
<span class="line" id="L511">        }</span>
<span class="line" id="L512">        <span class="tok-comment">/// Gets a StringHashMap of this Command's Values using the provided Allocator (`alloc`).</span></span>
<span class="line" id="L513">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">getValsAlloc</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), alloc: mem.Allocator, get_config: GetConfig) !StringHashMap(ValueT) {</span>
<span class="line" id="L514">            <span class="tok-kw">if</span> (self.vals == <span class="tok-null">null</span>) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.NoValuesInCommand;</span>
<span class="line" id="L515">            <span class="tok-kw">var</span> map = StringHashMap(ValueT).init(alloc);</span>
<span class="line" id="L516">            <span class="tok-kw">for</span> (self.vals.?) |val| { </span>
<span class="line" id="L517">                checkGroup: {</span>
<span class="line" id="L518">                    <span class="tok-kw">const</span> conf_group = get_config.arg_group <span class="tok-kw">orelse</span> <span class="tok-kw">break</span> :checkGroup;</span>
<span class="line" id="L519">                    <span class="tok-kw">const</span> val_group = val.valGroup() <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>;</span>
<span class="line" id="L520">                    <span class="tok-kw">if</span> (!mem.eql(<span class="tok-type">u8</span>, conf_group, val_group)) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L521">                }</span>
<span class="line" id="L522">                <span class="tok-kw">try</span> map.put(val.name(), val); </span>
<span class="line" id="L523">            }</span>
<span class="line" id="L524">            <span class="tok-kw">return</span> map;</span>
<span class="line" id="L525">        }</span>
<span class="line" id="L526"></span>
<span class="line" id="L527">        <span class="tok-comment">/// Creates the Help message for this Command and writes it to the provided Writer (`writer`).</span></span>
<span class="line" id="L528">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">help</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), writer: <span class="tok-kw">anytype</span>) !<span class="tok-type">void</span> {</span>
<span class="line" id="L529">            <span class="tok-kw">if</span> (global_help_fn) |helpFn| <span class="tok-kw">return</span> helpFn(self, writer, self._alloc <span class="tok-kw">orelse</span> <span class="tok-kw">return</span> <span class="tok-kw">error</span>.CommandNotInitialized);</span>
<span class="line" id="L530"></span>
<span class="line" id="L531">            <span class="tok-kw">const</span> alloc = self._alloc <span class="tok-kw">orelse</span> <span class="tok-kw">return</span> <span class="tok-kw">error</span>.CommandNotInitialized;</span>
<span class="line" id="L532">            </span>
<span class="line" id="L533">            <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;{s}\n&quot;</span>, .{ self.help_prefix });</span>
<span class="line" id="L534">            <span class="tok-kw">try</span> self.usage(writer);</span>
<span class="line" id="L535">            <span class="tok-kw">try</span> writer.print(help_header_fmt, .{ </span>
<span class="line" id="L536">                indent_fmt, self.name, </span>
<span class="line" id="L537">                indent_fmt, self.description </span>
<span class="line" id="L538">            });</span>
<span class="line" id="L539"></span>
<span class="line" id="L540">            <span class="tok-kw">if</span> (self.alias_names) |aliases| <span class="tok-kw">try</span> writer.print(cmd_alias_fmt, .{ indent_fmt, aliases });</span>
<span class="line" id="L541"></span>
<span class="line" id="L542">            <span class="tok-kw">if</span> (self.sub_cmds) |sub_cmds| {</span>
<span class="line" id="L543">                <span class="tok-kw">try</span> writer.print(subcmds_help_title_fmt, .{ indent_fmt });</span>
<span class="line" id="L544">                <span class="tok-kw">var</span> cmd_list = std.StringArrayHashMap(<span class="tok-builtin">@This</span>()).init(alloc);</span>
<span class="line" id="L545">                <span class="tok-kw">defer</span> cmd_list.deinit();</span>
<span class="line" id="L546">                <span class="tok-kw">for</span> (sub_cmds) |cmd| <span class="tok-kw">try</span> cmd_list.put(cmd.name, cmd);</span>
<span class="line" id="L547">                <span class="tok-kw">var</span> remove_list = std.ArrayList([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>).init(alloc);</span>
<span class="line" id="L548">                <span class="tok-kw">defer</span> remove_list.deinit();</span>
<span class="line" id="L549">                <span class="tok-kw">if</span> (self.cmd_groups) |groups| {</span>
<span class="line" id="L550">                    <span class="tok-kw">var</span> need_other_title = <span class="tok-null">false</span>;</span>
<span class="line" id="L551">                    <span class="tok-kw">for</span> (groups) |group| {</span>
<span class="line" id="L552">                        <span class="tok-kw">var</span> need_title = <span class="tok-null">true</span>;</span>
<span class="line" id="L553">                        <span class="tok-kw">var</span> cmd_iter = cmd_list.iterator();</span>
<span class="line" id="L554">                        cmdGroup: <span class="tok-kw">while</span> (cmd_iter.next()) |cmd_entry| {</span>
<span class="line" id="L555">                            <span class="tok-kw">const</span> cmd = cmd_entry.value_ptr;</span>
<span class="line" id="L556">                            <span class="tok-kw">if</span> (cmd.hidden) {</span>
<span class="line" id="L557">                                <span class="tok-kw">try</span> remove_list.append(cmd.name);</span>
<span class="line" id="L558">                                <span class="tok-kw">continue</span>;</span>
<span class="line" id="L559">                            }</span>
<span class="line" id="L560">                            <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, cmd.cmd_group <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :cmdGroup, group)) {</span>
<span class="line" id="L561">                                <span class="tok-kw">if</span> (need_title) {</span>
<span class="line" id="L562">                                    <span class="tok-kw">try</span> writer.print(group_title_fmt, .{ indent_fmt, group });</span>
<span class="line" id="L563">                                    need_title = <span class="tok-null">false</span>;</span>
<span class="line" id="L564">                                    need_other_title = <span class="tok-null">true</span>;</span>
<span class="line" id="L565">                                }</span>
<span class="line" id="L566">                                <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;{s}{s}&quot;</span>, .{ indent_fmt, indent_fmt });</span>
<span class="line" id="L567">                                <span class="tok-kw">try</span> writer.print(subcmds_help_fmt, .{ cmd.name, cmd.description });</span>
<span class="line" id="L568">                                <span class="tok-kw">if</span> (cmd.alias_names) |aliases| {</span>
<span class="line" id="L569">                                    <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n{s}{s}{s}&quot;</span>, .{ indent_fmt, indent_fmt, indent_fmt });</span>
<span class="line" id="L570">                                    <span class="tok-kw">try</span> writer.print(subcmd_alias_fmt, .{ aliases });</span>
<span class="line" id="L571">                                }</span>
<span class="line" id="L572">                                <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n&quot;</span>, .{});</span>
<span class="line" id="L573">                                <span class="tok-kw">try</span> remove_list.append(cmd.name);</span>
<span class="line" id="L574">                            }</span>
<span class="line" id="L575">                        }</span>
<span class="line" id="L576">                        <span class="tok-kw">if</span> (!need_title) <span class="tok-kw">try</span> writer.print(group_sep_fmt, .{ indent_fmt, indent_fmt });</span>
<span class="line" id="L577">                    }</span>
<span class="line" id="L578">                    <span class="tok-kw">if</span> (need_other_title <span class="tok-kw">and</span> remove_list.items.len &lt; cmd_list.count()) <span class="tok-kw">try</span> writer.print(group_title_fmt, .{ indent_fmt, <span class="tok-str">&quot;OTHER&quot;</span> });</span>
<span class="line" id="L579">                }</span>
<span class="line" id="L580">                <span class="tok-kw">for</span> (remove_list.items) |rem_name| _ = cmd_list.orderedRemove(rem_name);</span>
<span class="line" id="L581"></span>
<span class="line" id="L582">                <span class="tok-kw">var</span> cmd_iter = cmd_list.iterator();</span>
<span class="line" id="L583">                <span class="tok-kw">while</span> (cmd_iter.next()) |cmd_entry| {</span>
<span class="line" id="L584">                    <span class="tok-kw">const</span> cmd = cmd_entry.value_ptr;</span>
<span class="line" id="L585">                    <span class="tok-kw">if</span> (cmd.hidden) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L586">                    <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;{s}{s}&quot;</span>, .{ indent_fmt, indent_fmt });</span>
<span class="line" id="L587">                    <span class="tok-kw">try</span> writer.print(subcmds_help_fmt, .{ cmd.name, cmd.description });</span>
<span class="line" id="L588">                    <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n&quot;</span>, .{});</span>
<span class="line" id="L589">                }</span>
<span class="line" id="L590">            }</span>
<span class="line" id="L591">            <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n&quot;</span>, .{});</span>
<span class="line" id="L592"></span>
<span class="line" id="L593">            <span class="tok-kw">if</span> (self.opts) |opts| {</span>
<span class="line" id="L594">                <span class="tok-kw">try</span> writer.print(opts_help_title_fmt, .{ indent_fmt });</span>
<span class="line" id="L595">                <span class="tok-kw">var</span> opt_list = std.StringArrayHashMap(OptionT).init(alloc);</span>
<span class="line" id="L596">                <span class="tok-kw">defer</span> opt_list.deinit();</span>
<span class="line" id="L597">                <span class="tok-kw">for</span> (opts) |opt| <span class="tok-kw">try</span> opt_list.put(opt.name, opt);</span>
<span class="line" id="L598">                <span class="tok-kw">var</span> remove_list = std.ArrayList([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>).init(alloc);</span>
<span class="line" id="L599">                <span class="tok-kw">defer</span> remove_list.deinit();</span>
<span class="line" id="L600">                <span class="tok-kw">if</span> (self.opt_groups) |groups| {</span>
<span class="line" id="L601">                    <span class="tok-kw">var</span> need_other_title = <span class="tok-null">false</span>;</span>
<span class="line" id="L602">                    <span class="tok-kw">for</span> (groups) |group| {</span>
<span class="line" id="L603">                        <span class="tok-kw">var</span> need_title = <span class="tok-null">true</span>;</span>
<span class="line" id="L604">                        <span class="tok-kw">var</span> opt_iter = opt_list.iterator();</span>
<span class="line" id="L605">                        optGroup: <span class="tok-kw">while</span> (opt_iter.next()) |opt_entry| {</span>
<span class="line" id="L606">                            <span class="tok-kw">const</span> opt = opt_entry.value_ptr;</span>
<span class="line" id="L607">                            <span class="tok-kw">if</span> (opt.hidden) {</span>
<span class="line" id="L608">                                <span class="tok-kw">try</span> remove_list.append(opt.name);</span>
<span class="line" id="L609">                                <span class="tok-kw">continue</span>;</span>
<span class="line" id="L610">                            }</span>
<span class="line" id="L611">                            <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, opt.opt_group <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :optGroup, group)) {</span>
<span class="line" id="L612">                                <span class="tok-kw">if</span> (need_title) {</span>
<span class="line" id="L613">                                    <span class="tok-kw">try</span> writer.print(group_title_fmt, .{ indent_fmt, group });</span>
<span class="line" id="L614">                                    need_title = <span class="tok-null">false</span>;</span>
<span class="line" id="L615">                                    need_other_title = <span class="tok-null">true</span>;</span>
<span class="line" id="L616">                                }</span>
<span class="line" id="L617">                                <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;{s}{s}&quot;</span>, .{ indent_fmt, indent_fmt });</span>
<span class="line" id="L618">                                <span class="tok-kw">try</span> opt.help(writer);</span>
<span class="line" id="L619">                                <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n&quot;</span>, .{});</span>
<span class="line" id="L620">                                <span class="tok-kw">try</span> remove_list.append(opt.name);</span>
<span class="line" id="L621">                            }</span>
<span class="line" id="L622">                        }</span>
<span class="line" id="L623">                        <span class="tok-kw">if</span> (!need_title) <span class="tok-kw">try</span> writer.print(group_sep_fmt, .{ indent_fmt, indent_fmt });</span>
<span class="line" id="L624">                    }</span>
<span class="line" id="L625">                    <span class="tok-kw">if</span> (need_other_title <span class="tok-kw">and</span> remove_list.items.len &lt; opt_list.count()) <span class="tok-kw">try</span> writer.print(group_title_fmt, .{ indent_fmt, <span class="tok-str">&quot;OTHER&quot;</span> });</span>
<span class="line" id="L626">                }</span>
<span class="line" id="L627">                <span class="tok-kw">for</span> (remove_list.items) |rem_name| _ = opt_list.orderedRemove(rem_name);</span>
<span class="line" id="L628"></span>
<span class="line" id="L629">                <span class="tok-kw">var</span> opt_iter = opt_list.iterator();</span>
<span class="line" id="L630">                <span class="tok-kw">while</span> (opt_iter.next()) |opt_entry| {</span>
<span class="line" id="L631">                    <span class="tok-kw">const</span> opt = opt_entry.value_ptr;</span>
<span class="line" id="L632">                    <span class="tok-kw">if</span> (opt.hidden) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L633">                    <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;{s}{s}&quot;</span>, .{ indent_fmt, indent_fmt });</span>
<span class="line" id="L634">                    <span class="tok-kw">try</span> opt.help(writer);</span>
<span class="line" id="L635">                    <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n&quot;</span>, .{});</span>
<span class="line" id="L636">                }</span>
<span class="line" id="L637">            }</span>
<span class="line" id="L638">            <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n&quot;</span>, .{});</span>
<span class="line" id="L639"></span>
<span class="line" id="L640">            <span class="tok-kw">if</span> (self.vals) |vals| {</span>
<span class="line" id="L641">                <span class="tok-kw">try</span> writer.print(vals_help_title_fmt, .{ indent_fmt });</span>
<span class="line" id="L642">                <span class="tok-kw">var</span> val_list = std.StringArrayHashMap(ValueT).init(alloc);</span>
<span class="line" id="L643">                <span class="tok-kw">defer</span> val_list.deinit();</span>
<span class="line" id="L644">                <span class="tok-kw">for</span> (vals) |val| <span class="tok-kw">try</span> val_list.put(val.name(), val);</span>
<span class="line" id="L645">                <span class="tok-kw">var</span> remove_list = std.ArrayList([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>).init(alloc);</span>
<span class="line" id="L646">                <span class="tok-kw">defer</span> remove_list.deinit();</span>
<span class="line" id="L647">                <span class="tok-kw">if</span> (self.val_groups) |groups| {</span>
<span class="line" id="L648">                    <span class="tok-kw">var</span> need_other_title = <span class="tok-null">false</span>;</span>
<span class="line" id="L649">                    <span class="tok-kw">for</span> (groups) |group| {</span>
<span class="line" id="L650">                        <span class="tok-kw">var</span> need_title = <span class="tok-null">true</span>;</span>
<span class="line" id="L651">                        <span class="tok-kw">var</span> val_iter = val_list.iterator();</span>
<span class="line" id="L652">                        valGroup: <span class="tok-kw">while</span> (val_iter.next()) |val_entry| {</span>
<span class="line" id="L653">                            <span class="tok-kw">const</span> val = val_entry.value_ptr;</span>
<span class="line" id="L654">                            <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, val.valGroup() <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :valGroup, group)) {</span>
<span class="line" id="L655">                                <span class="tok-kw">if</span> (need_title) {</span>
<span class="line" id="L656">                                    <span class="tok-kw">try</span> writer.print(group_title_fmt, .{ indent_fmt, group });</span>
<span class="line" id="L657">                                    need_title = <span class="tok-null">false</span>;</span>
<span class="line" id="L658">                                    need_other_title = <span class="tok-null">true</span>;</span>
<span class="line" id="L659">                                }</span>
<span class="line" id="L660">                                <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;{s}{s}&quot;</span>, .{ indent_fmt, indent_fmt });</span>
<span class="line" id="L661">                                <span class="tok-kw">try</span> val.help(writer);</span>
<span class="line" id="L662">                                <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n&quot;</span>, .{});</span>
<span class="line" id="L663">                                <span class="tok-kw">try</span> remove_list.append(val.name());</span>
<span class="line" id="L664">                            }</span>
<span class="line" id="L665">                        }</span>
<span class="line" id="L666">                        <span class="tok-kw">if</span> (!need_title) <span class="tok-kw">try</span> writer.print(group_sep_fmt, .{ indent_fmt, indent_fmt });</span>
<span class="line" id="L667">                    }</span>
<span class="line" id="L668">                    <span class="tok-kw">if</span> (need_other_title <span class="tok-kw">and</span> remove_list.items.len &lt; val_list.count()) <span class="tok-kw">try</span> writer.print(group_title_fmt, .{ indent_fmt, <span class="tok-str">&quot;OTHER&quot;</span> });</span>
<span class="line" id="L669">                }</span>
<span class="line" id="L670">                <span class="tok-kw">for</span> (remove_list.items) |rem_name| _ = val_list.orderedRemove(rem_name);</span>
<span class="line" id="L671"></span>
<span class="line" id="L672">                <span class="tok-kw">var</span> val_iter = val_list.iterator();</span>
<span class="line" id="L673">                <span class="tok-kw">while</span> (val_iter.next()) |val_entry| {</span>
<span class="line" id="L674">                    <span class="tok-kw">const</span> val = val_entry.value_ptr;</span>
<span class="line" id="L675">                    <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;{s}{s}&quot;</span>, .{ indent_fmt, indent_fmt });</span>
<span class="line" id="L676">                    <span class="tok-kw">try</span> val.help(writer);</span>
<span class="line" id="L677">                    <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n&quot;</span>, .{});</span>
<span class="line" id="L678">                }</span>
<span class="line" id="L679">            }</span>
<span class="line" id="L680">            <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n&quot;</span>, .{});</span>
<span class="line" id="L681">        }</span>
<span class="line" id="L682"></span>
<span class="line" id="L683">        <span class="tok-comment">/// Creates the Usage message for this Command and writes it to the provided Writer (`writer`).</span></span>
<span class="line" id="L684">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">usage</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), writer: <span class="tok-kw">anytype</span>) !<span class="tok-type">void</span> {</span>
<span class="line" id="L685">            <span class="tok-kw">if</span> (global_usage_fn) |usageFn| <span class="tok-kw">return</span> usageFn(self, writer, self._alloc <span class="tok-kw">orelse</span> <span class="tok-kw">return</span> <span class="tok-kw">error</span>.CommandNotInitialized);</span>
<span class="line" id="L686"></span>
<span class="line" id="L687">            <span class="tok-kw">try</span> writer.print(usage_header_fmt, .{ indent_fmt, self.name });</span>
<span class="line" id="L688">            <span class="tok-kw">if</span> (self.opts) |opts| {</span>
<span class="line" id="L689">                <span class="tok-kw">var</span> post_sep: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot; | &quot;</span>;</span>
<span class="line" id="L690">                <span class="tok-kw">var</span> hidden_count: <span class="tok-type">u8</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L691">                <span class="tok-kw">for</span> (opts, <span class="tok-number">0</span>..) |opt, idx| {</span>
<span class="line" id="L692">                    <span class="tok-kw">if</span> (opt.hidden) {</span>
<span class="line" id="L693">                        hidden_count += <span class="tok-number">1</span>;</span>
<span class="line" id="L694">                        <span class="tok-kw">continue</span>;</span>
<span class="line" id="L695">                    }</span>
<span class="line" id="L696">                    <span class="tok-kw">try</span> opt.usage(writer);</span>
<span class="line" id="L697">                    <span class="tok-kw">if</span> (idx == opts.len - <span class="tok-number">1</span>) post_sep = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L698">                    <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;{s}&quot;</span>, .{ post_sep });</span>
<span class="line" id="L699">                }</span>
<span class="line" id="L700">                <span class="tok-kw">if</span> (hidden_count &lt; opts.len) <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n{s}{s} &quot;</span>, .{ indent_fmt, self.name });</span>
<span class="line" id="L701">            }</span>
<span class="line" id="L702">            <span class="tok-kw">if</span> (self.vals) |vals| {</span>
<span class="line" id="L703">                <span class="tok-kw">var</span> post_sep: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot; | &quot;</span>;</span>
<span class="line" id="L704">                <span class="tok-kw">for</span> (vals, <span class="tok-number">0</span>..) |val, idx| {</span>
<span class="line" id="L705">                    <span class="tok-kw">try</span> val.usage(writer);</span>
<span class="line" id="L706">                    <span class="tok-kw">if</span> (idx == vals.len - <span class="tok-number">1</span>) post_sep = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L707">                    <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;{s}&quot;</span>, .{ post_sep });</span>
<span class="line" id="L708">                }</span>
<span class="line" id="L709">                <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n{s}{s} &quot;</span>, .{ indent_fmt, self.name });</span>
<span class="line" id="L710">            }</span>
<span class="line" id="L711">            <span class="tok-kw">if</span> (self.sub_cmds) |cmds| {</span>
<span class="line" id="L712">                <span class="tok-kw">var</span> post_sep: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot; | &quot;</span>;</span>
<span class="line" id="L713">                <span class="tok-kw">for</span> (cmds, <span class="tok-number">0</span>..) |cmd, idx| {</span>
<span class="line" id="L714">                    <span class="tok-kw">if</span> (cmd.hidden) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L715">                    <span class="tok-kw">try</span> writer.print(subcmds_usage_fmt, .{ cmd.name });</span>
<span class="line" id="L716">                    <span class="tok-kw">if</span> (idx == cmds.len - <span class="tok-number">1</span>) post_sep = <span class="tok-str">&quot;&quot;</span>;</span>
<span class="line" id="L717">                    <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;{s}&quot;</span>, .{ post_sep });</span>
<span class="line" id="L718">                }</span>
<span class="line" id="L719">            } </span>
<span class="line" id="L720"></span>
<span class="line" id="L721">            <span class="tok-kw">try</span> writer.print(<span class="tok-str">&quot;\n\n&quot;</span>, .{});</span>
<span class="line" id="L722">        }</span>
<span class="line" id="L723"></span>
<span class="line" id="L724">        <span class="tok-comment">/// Check if Usage or Help have been set and call their respective methods.</span></span>
<span class="line" id="L725">        <span class="tok-comment">/// Output will be written to the provided Writer (`writer`).</span></span>
<span class="line" id="L726">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">checkUsageHelp</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), writer: <span class="tok-kw">anytype</span>) !<span class="tok-type">bool</span> {</span>
<span class="line" id="L727">            <span class="tok-kw">if</span> (self.checkFlag(<span class="tok-str">&quot;usage&quot;</span>)) {</span>
<span class="line" id="L728">                <span class="tok-kw">try</span> self.usage(writer);</span>
<span class="line" id="L729">                <span class="tok-kw">return</span> <span class="tok-null">true</span>;</span>
<span class="line" id="L730">            }</span>
<span class="line" id="L731">            <span class="tok-kw">if</span> (self.checkFlag(<span class="tok-str">&quot;help&quot;</span>)) {</span>
<span class="line" id="L732">                <span class="tok-kw">try</span> self.help(writer);</span>
<span class="line" id="L733">                <span class="tok-kw">return</span> <span class="tok-null">true</span>;</span>
<span class="line" id="L734">            }</span>
<span class="line" id="L735">            <span class="tok-kw">return</span> <span class="tok-null">false</span>;</span>
<span class="line" id="L736">        }</span>
<span class="line" id="L737"></span>
<span class="line" id="L738">        <span class="tok-comment">/// Check if a Flag (`flag_name`) has been set on this Command as a Command, Option, or Value.</span></span>
<span class="line" id="L739">        <span class="tok-comment">/// This is particularly useful for checking if Help or Usage has been called.</span></span>
<span class="line" id="L740">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">checkFlag</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), flag_name: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <span class="tok-type">bool</span> {</span>
<span class="line" id="L741">            <span class="tok-kw">return</span> (</span>
<span class="line" id="L742">                (self.sub_cmd != <span class="tok-null">null</span> <span class="tok-kw">and</span> mem.eql(<span class="tok-type">u8</span>, self.sub_cmd.?.name, flag_name)) <span class="tok-kw">or</span></span>
<span class="line" id="L743">                checkOpt: {</span>
<span class="line" id="L744">                    <span class="tok-kw">if</span> (self.opts != <span class="tok-null">null</span>) {</span>
<span class="line" id="L745">                        <span class="tok-kw">for</span> (self.opts.?) |opt| {</span>
<span class="line" id="L746">                            <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, opt.name, flag_name) <span class="tok-kw">and</span> </span>
<span class="line" id="L747">                                mem.eql(<span class="tok-type">u8</span>, opt.val.childType(), <span class="tok-str">&quot;bool&quot;</span>) <span class="tok-kw">and</span> </span>
<span class="line" id="L748">                                opt.val.getAs(<span class="tok-type">bool</span>) <span class="tok-kw">catch</span> <span class="tok-null">false</span>)</span>
<span class="line" id="L749">                                    <span class="tok-kw">break</span> :checkOpt <span class="tok-null">true</span>;</span>
<span class="line" id="L750">                        }</span>
<span class="line" id="L751">                    }</span>
<span class="line" id="L752">                    <span class="tok-kw">break</span> :checkOpt <span class="tok-null">false</span>;</span>
<span class="line" id="L753">                } <span class="tok-kw">or</span></span>
<span class="line" id="L754">                checkVal: {</span>
<span class="line" id="L755">                    <span class="tok-kw">if</span> (self.vals != <span class="tok-null">null</span>) {</span>
<span class="line" id="L756">                        <span class="tok-kw">for</span> (self.vals.?) |val| {</span>
<span class="line" id="L757">                            <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, val.name(), flag_name) <span class="tok-kw">and</span></span>
<span class="line" id="L758">                                mem.eql(<span class="tok-type">u8</span>, val.childType(), <span class="tok-str">&quot;bool&quot;</span>) <span class="tok-kw">and</span></span>
<span class="line" id="L759">                                val.getAs(<span class="tok-type">bool</span>) <span class="tok-kw">catch</span> <span class="tok-null">false</span>)</span>
<span class="line" id="L760">                                    <span class="tok-kw">break</span> :checkVal <span class="tok-null">true</span>;</span>
<span class="line" id="L761">                        }</span>
<span class="line" id="L762">                    }</span>
<span class="line" id="L763">                    <span class="tok-kw">break</span> :checkVal <span class="tok-null">false</span>;</span>
<span class="line" id="L764">                }</span>
<span class="line" id="L765">            );</span>
<span class="line" id="L766">        }</span>
<span class="line" id="L767"></span>
<span class="line" id="L768">        <span class="tok-comment">/// Config for creating Commands from Structs using `from()`.</span></span>
<span class="line" id="L769">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> FromConfig = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L770">            <span class="tok-comment">/// Ignore incompatible Types.</span></span>
<span class="line" id="L771">            ignore_incompatible: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L772">            <span class="tok-comment">/// Ignore prefix.</span></span>
<span class="line" id="L773">            <span class="tok-comment">/// Any Field that matches this prefix will not be converted in to an Argument Type.</span></span>
<span class="line" id="L774">            <span class="tok-comment">/// Setting this to `null` will disable prefix checks.</span></span>
<span class="line" id="L775">            ignore_prefix: ?[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;_&quot;</span>,</span>
<span class="line" id="L776">            <span class="tok-comment">/// Ignore the first field or parameter.</span></span>
<span class="line" id="L777">            <span class="tok-comment">/// This is particularly useful when converting a Function that has a `self` parameter.</span></span>
<span class="line" id="L778">            ignore_first: <span class="tok-type">bool</span> = <span class="tok-null">false</span>,</span>
<span class="line" id="L779">            <span class="tok-comment">/// Convert underscores '_' to dashes '-' in field names.</span></span>
<span class="line" id="L780">            <span class="tok-comment">/// Be sure to set the counterpart to this flag in the `ToConfig` if this Command will be converted back to a Struct or Union.</span></span>
<span class="line" id="L781">            convert_syntax: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L782">            <span class="tok-comment">/// Attempt to create Short Options.</span></span>
<span class="line" id="L783">            <span class="tok-comment">/// This will attempt to make a short option name from the first letter of the field name in lowercase then uppercase, </span></span>
<span class="line" id="L784">            <span class="tok-comment">/// sequentially working through each next letter if the previous one has already been used. </span></span>
<span class="line" id="L785">            <span class="tok-comment">/// (Note, user must deconflict for 'u' and 'h' if using auto-generated Usage/Help Options.)</span></span>
<span class="line" id="L786">            attempt_short_opts: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L787">            <span class="tok-comment">/// Convert Fields with default values to Options instead of Values.</span></span>
<span class="line" id="L788">            <span class="tok-comment">/// There's a corresponding field in the `ToConfig`.</span></span>
<span class="line" id="L789">            default_val_opts: <span class="tok-type">bool</span> = <span class="tok-null">false</span>,</span>
<span class="line" id="L790"></span>
<span class="line" id="L791">            <span class="tok-comment">/// A Name for the Command.</span></span>
<span class="line" id="L792">            <span class="tok-comment">/// A null value will default to the type name of the Struct.</span></span>
<span class="line" id="L793">            cmd_name: ?[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L794">            <span class="tok-comment">/// A list of Alias Names for this Command.</span></span>
<span class="line" id="L795">            cmd_alias_names: ?[]<span class="tok-kw">const</span> []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L796">            <span class="tok-comment">/// A Description for the Command.</span></span>
<span class="line" id="L797">            cmd_description: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;&quot;</span>,</span>
<span class="line" id="L798">            <span class="tok-comment">/// A Help Prefix for the Command.</span></span>
<span class="line" id="L799">            cmd_help_prefix: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = global_help_prefix,</span>
<span class="line" id="L800">            <span class="tok-comment">/// Command Groups for this Command</span></span>
<span class="line" id="L801">            cmd_groups: ?[]<span class="tok-kw">const</span> []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L802">            <span class="tok-comment">/// Command Group for this Command.</span></span>
<span class="line" id="L803">            cmd_group: ?[]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-null">null</span>,</span>
<span class="line" id="L804">            <span class="tok-comment">/// Hide this Command.</span></span>
<span class="line" id="L805">            cmd_hidden: <span class="tok-type">bool</span> = <span class="tok-null">false</span>,</span>
<span class="line" id="L806"></span>
<span class="line" id="L807">            <span class="tok-comment">/// Descriptions of the Command's Arguments (Sub Commands, Options, and Values).</span></span>
<span class="line" id="L808">            <span class="tok-comment">/// These Descriptions will be used across this Command and all of its Sub Commands.</span></span>
<span class="line" id="L809">            <span class="tok-comment">///</span></span>
<span class="line" id="L810">            <span class="tok-comment">/// Format: `.{ &quot;argument_name&quot;, &quot;Description of the Argument.&quot; }`</span></span>
<span class="line" id="L811">            sub_descriptions: []<span class="tok-kw">const</span> <span class="tok-kw">struct</span> { []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, []<span class="tok-kw">const</span> <span class="tok-type">u8</span> } = &amp;.{ .{ <span class="tok-str">&quot;__nosubdescriptionsprovided__&quot;</span>, <span class="tok-str">&quot;&quot;</span> } },</span>
<span class="line" id="L812">            <span class="tok-comment">/// During parsing, mandate that a Sub Command be used with a Command if one is available.</span></span>
<span class="line" id="L813">            <span class="tok-comment">/// This will not include Usage/Help Commands.</span></span>
<span class="line" id="L814">            sub_cmds_mandatory: <span class="tok-type">bool</span> = config.global_sub_cmds_mandatory,</span>
<span class="line" id="L815">            <span class="tok-comment">/// During parsing, mandate that all Values for a Command must be filled, otherwise error out.</span></span>
<span class="line" id="L816">            <span class="tok-comment">/// This should generally be set to `true`. Prefer to use Options over Values for Arguments that are not mandatory.</span></span>
<span class="line" id="L817">            vals_mandatory: <span class="tok-type">bool</span> = config.global_vals_mandatory,</span>
<span class="line" id="L818">            <span class="tok-comment">/// During parsing, mandate that THIS Command, and its aliases, must be used in a case-sensitive manner.</span></span>
<span class="line" id="L819">            <span class="tok-comment">/// This will NOT affect Command Validation nor Tab-Completion.</span></span>
<span class="line" id="L820">            case_sensitive: <span class="tok-type">bool</span> = config.global_case_sensitive,</span>
<span class="line" id="L821"></span>
<span class="line" id="L822">            <span class="tok-comment">/// Max number of Sub Commands.</span></span>
<span class="line" id="L823">            max_cmds: <span class="tok-type">u8</span> = max_args,</span>
<span class="line" id="L824">            <span class="tok-comment">/// Max number of Options.</span></span>
<span class="line" id="L825">            max_opts: <span class="tok-type">u8</span> = max_args,</span>
<span class="line" id="L826">            <span class="tok-comment">/// Max number of Values.</span></span>
<span class="line" id="L827">            max_vals: <span class="tok-type">u8</span> = max_args,</span>
<span class="line" id="L828">        };</span>
<span class="line" id="L829">        </span>
<span class="line" id="L830">        <span class="tok-comment">/// Create a Command from the provided Type (`FromT`).</span></span>
<span class="line" id="L831">        <span class="tok-comment">/// The provided Type must be a Comptime-known Function, Struct, or Union.</span></span>
<span class="line" id="L832">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">from</span>(<span class="tok-kw">comptime</span> FromT: <span class="tok-type">type</span>, <span class="tok-kw">comptime</span> from_config: FromConfig) <span class="tok-builtin">@This</span>() {</span>
<span class="line" id="L833">            <span class="tok-kw">const</span> from_info = <span class="tok-builtin">@typeInfo</span>(FromT);</span>
<span class="line" id="L834">            <span class="tok-kw">return</span> <span class="tok-kw">switch</span> (from_info) {</span>
<span class="line" id="L835">                .Fn =&gt; fromFn(FromT, from_config),</span>
<span class="line" id="L836">                .Struct, .Union =&gt; fromStructOrUnion(FromT, from_config),</span>
<span class="line" id="L837">                <span class="tok-kw">else</span> =&gt; <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The provided type '&quot;</span> ++ <span class="tok-builtin">@typeName</span>(FromT) ++ <span class="tok-str">&quot;' must be a Function, Struct, or Union.&quot;</span>),</span>
<span class="line" id="L838">            };</span>
<span class="line" id="L839">        }</span>
<span class="line" id="L840"></span>
<span class="line" id="L841">        <span class="tok-comment">/// Create a Command from the provided Struct (`FromStruct`).</span></span>
<span class="line" id="L842">        <span class="tok-comment">/// The provided Struct must be Comptime-known.</span></span>
<span class="line" id="L843">        <span class="tok-comment">///</span></span>
<span class="line" id="L844">        <span class="tok-comment">/// Field Types are converted as follows:</span></span>
<span class="line" id="L845">        <span class="tok-comment">/// - Functions, Structs, Unions = Commands</span></span>
<span class="line" id="L846">        <span class="tok-comment">/// - Valid Values = Single-Values (Valid Values can be found under `Value.zig/Generic`.)</span></span>
<span class="line" id="L847">        <span class="tok-comment">/// - Valid Optionals = Single-Options (Valid Optionals are nullable versions of Valid Values.)</span></span>
<span class="line" id="L848">        <span class="tok-comment">/// - Arrays of Valid Values = Multi-Values</span></span>
<span class="line" id="L849">        <span class="tok-comment">/// - Arrays of Valid Optionals = Multi-Options</span></span>
<span class="line" id="L850">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">fromStructOrUnion</span>(<span class="tok-kw">comptime</span> FromT: <span class="tok-type">type</span>, <span class="tok-kw">comptime</span> from_config: FromConfig) <span class="tok-builtin">@This</span>() {</span>
<span class="line" id="L851">            <span class="tok-kw">const</span> from_info = <span class="tok-builtin">@typeInfo</span>(FromT);</span>
<span class="line" id="L852">            <span class="tok-kw">if</span> (from_info != .Struct <span class="tok-kw">and</span> from_info != .Union) <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;Provided Type is not a Struct or Union.&quot;</span>);</span>
<span class="line" id="L853"></span>
<span class="line" id="L854">            <span class="tok-kw">var</span> from_cmds_buf: [from_config.max_cmds]<span class="tok-builtin">@This</span>() = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L855">            <span class="tok-kw">const</span> from_cmds = from_cmds_buf[<span class="tok-number">0</span>..];</span>
<span class="line" id="L856">            <span class="tok-kw">var</span> cmds_idx: <span class="tok-type">u8</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L857">            <span class="tok-kw">var</span> from_opts_buf: [from_config.max_opts]OptionT = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L858">            <span class="tok-kw">const</span> from_opts = from_opts_buf[<span class="tok-number">0</span>..];</span>
<span class="line" id="L859">            <span class="tok-kw">var</span> opts_idx: <span class="tok-type">u8</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L860">            <span class="tok-kw">var</span> short_names_buf: [from_config.max_opts]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L861">            <span class="tok-kw">const</span> short_names = short_names_buf[<span class="tok-number">0</span>..];</span>
<span class="line" id="L862">            <span class="tok-kw">var</span> short_idx: <span class="tok-type">u8</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L863">            <span class="tok-kw">var</span> from_vals_buf: [from_config.max_vals]ValueT = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L864">            <span class="tok-kw">const</span> from_vals = from_vals_buf[<span class="tok-number">0</span>..];</span>
<span class="line" id="L865">            <span class="tok-kw">var</span> vals_idx: <span class="tok-type">u8</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L866"></span>
<span class="line" id="L867">            <span class="tok-comment">// TODO: Make this a nullable field and just use null conditional syntax for adding descriptions below.</span>
</span>
<span class="line" id="L868">            <span class="tok-kw">const</span> arg_descriptions = ComptimeStringMap([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, from_config.sub_descriptions);</span>
<span class="line" id="L869"></span>
<span class="line" id="L870">            <span class="tok-kw">const</span> fields = meta.fields(FromT);</span>
<span class="line" id="L871">            <span class="tok-kw">const</span> start_idx = <span class="tok-kw">if</span> (from_config.ignore_first) <span class="tok-number">1</span> <span class="tok-kw">else</span> <span class="tok-number">0</span>;</span>
<span class="line" id="L872">            <span class="tok-kw">inline</span> <span class="tok-kw">for</span> (fields[start_idx..]) |field| {</span>
<span class="line" id="L873">                <span class="tok-kw">if</span> (from_config.ignore_prefix) |prefix| {</span>
<span class="line" id="L874">                    <span class="tok-kw">if</span> (field.name.len &gt; prefix.len <span class="tok-kw">and</span> mem.eql(<span class="tok-type">u8</span>, field.name[<span class="tok-number">0</span>..prefix.len], prefix)) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L875">                }</span>
<span class="line" id="L876">                <span class="tok-kw">var</span> arg_name_buf: [field.name.len]<span class="tok-type">u8</span> = field.name[<span class="tok-number">0</span>..].*;</span>
<span class="line" id="L877">                <span class="tok-kw">const</span> arg_name = <span class="tok-kw">if</span> (!from_config.convert_syntax) field.name <span class="tok-kw">else</span> argName: {</span>
<span class="line" id="L878">                    _ = mem.replace(<span class="tok-type">u8</span>, field.name[<span class="tok-number">1</span>..], <span class="tok-str">&quot;_&quot;</span>, <span class="tok-str">&quot;-&quot;</span>, arg_name_buf[<span class="tok-number">1</span>..]);</span>
<span class="line" id="L879">                    <span class="tok-kw">break</span> :argName arg_name_buf[<span class="tok-number">0</span>..];</span>
<span class="line" id="L880">                };</span>
<span class="line" id="L881">                <span class="tok-kw">const</span> arg_description = arg_descriptions.get(field.name);</span>
<span class="line" id="L882">                <span class="tok-comment">// Handle Argument Types.</span>
</span>
<span class="line" id="L883">                <span class="tok-kw">switch</span> (field.<span class="tok-type">type</span>) {</span>
<span class="line" id="L884">                    <span class="tok-builtin">@This</span>() =&gt; {</span>
<span class="line" id="L885">                        <span class="tok-kw">if</span> (field.default_value != <span class="tok-null">null</span>) {</span>
<span class="line" id="L886">                            from_cmds[cmds_idx] = <span class="tok-builtin">@as</span>(*field.<span class="tok-type">type</span>, <span class="tok-builtin">@ptrCast</span>(<span class="tok-builtin">@alignCast</span>(<span class="tok-builtin">@constCast</span>(field.default_value)))).*;</span>
<span class="line" id="L887">                            cmds_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L888">                            <span class="tok-kw">continue</span>;</span>
<span class="line" id="L889">                        }</span>
<span class="line" id="L890">                    },</span>
<span class="line" id="L891">                    OptionT =&gt; {</span>
<span class="line" id="L892">                        <span class="tok-kw">if</span> (field.default_value != <span class="tok-null">null</span>) {</span>
<span class="line" id="L893">                            from_opts[opts_idx] = <span class="tok-builtin">@as</span>(*field.<span class="tok-type">type</span>, <span class="tok-builtin">@ptrCast</span>(<span class="tok-builtin">@alignCast</span>(<span class="tok-builtin">@constCast</span>(field.default_value)))).*;</span>
<span class="line" id="L894">                            opts_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L895">                            <span class="tok-kw">continue</span>;</span>
<span class="line" id="L896">                        }</span>
<span class="line" id="L897">                    },</span>
<span class="line" id="L898">                    ValueT =&gt; {</span>
<span class="line" id="L899">                        <span class="tok-kw">if</span> (field.default_value != <span class="tok-null">null</span>) {</span>
<span class="line" id="L900">                            from_vals[vals_idx] = <span class="tok-builtin">@as</span>(*field.<span class="tok-type">type</span>, <span class="tok-builtin">@ptrCast</span>(<span class="tok-builtin">@alignCast</span>(<span class="tok-builtin">@constCast</span>(field.default_value)))).*;</span>
<span class="line" id="L901">                            vals_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L902">                            <span class="tok-kw">continue</span>;</span>
<span class="line" id="L903">                        }</span>
<span class="line" id="L904">                    },</span>
<span class="line" id="L905">                    <span class="tok-kw">else</span> =&gt; {},</span>
<span class="line" id="L906">                }</span>
<span class="line" id="L907"></span>
<span class="line" id="L908">                <span class="tok-kw">const</span> field_info = <span class="tok-builtin">@typeInfo</span>(field.<span class="tok-type">type</span>);</span>
<span class="line" id="L909">                <span class="tok-comment">// Handle non-Argument Types.</span>
</span>
<span class="line" id="L910">                <span class="tok-kw">switch</span> (field_info) {</span>
<span class="line" id="L911">                    <span class="tok-comment">// Commands</span>
</span>
<span class="line" id="L912">                    .Fn, .Struct =&gt; {</span>
<span class="line" id="L913">                        <span class="tok-kw">const</span> sub_config = <span class="tok-kw">comptime</span> subConfig: {</span>
<span class="line" id="L914">                            <span class="tok-kw">var</span> new_config = from_config;</span>
<span class="line" id="L915">                            new_config.cmd_name = arg_name;</span>
<span class="line" id="L916">                            new_config.cmd_description = arg_description <span class="tok-kw">orelse</span> <span class="tok-str">&quot;The '&quot;</span> ++ arg_name ++ <span class="tok-str">&quot;' Command.&quot;</span>;</span>
<span class="line" id="L917">                            <span class="tok-kw">break</span> :subConfig new_config;</span>
<span class="line" id="L918">                        };</span>
<span class="line" id="L919">                        from_cmds[cmds_idx] = from(field.<span class="tok-type">type</span>, sub_config);</span>
<span class="line" id="L920">                        cmds_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L921">                    },</span>
<span class="line" id="L922">                    <span class="tok-comment">// Options</span>
</span>
<span class="line" id="L923">                    <span class="tok-comment">// TODO - Handle Command types passed as Optionals?</span>
</span>
<span class="line" id="L924">                    .Optional =&gt; {</span>
<span class="line" id="L925">                        from_opts[opts_idx] = (OptionT.from(field, .{ </span>
<span class="line" id="L926">                            .name = arg_name,</span>
<span class="line" id="L927">                            .short_name = <span class="tok-kw">if</span> (from_config.attempt_short_opts) optShortName(arg_name, short_names, &amp;short_idx) <span class="tok-kw">else</span> <span class="tok-null">null</span>, </span>
<span class="line" id="L928">                            .long_name = arg_name,</span>
<span class="line" id="L929">                            .ignore_incompatible = from_config.ignore_incompatible,</span>
<span class="line" id="L930">                            .opt_description = arg_description,</span>
<span class="line" id="L931">                        }) <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>);</span>
<span class="line" id="L932">                        opts_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L933">                    },</span>
<span class="line" id="L934">                    <span class="tok-comment">// Values</span>
</span>
<span class="line" id="L935">                    .Bool, .Int, .Float, .Pointer, .Enum =&gt; {</span>
<span class="line" id="L936">                        <span class="tok-kw">if</span> (from_config.default_val_opts <span class="tok-kw">and</span> field.default_value != <span class="tok-null">null</span>) {</span>
<span class="line" id="L937">                            from_opts[opts_idx] = (OptionT.from(field, .{ </span>
<span class="line" id="L938">                                .name = arg_name,</span>
<span class="line" id="L939">                                .short_name = <span class="tok-kw">if</span> (from_config.attempt_short_opts) optShortName(arg_name, short_names, &amp;short_idx) <span class="tok-kw">else</span> <span class="tok-null">null</span>, </span>
<span class="line" id="L940">                                .long_name = arg_name,</span>
<span class="line" id="L941">                                .ignore_incompatible = from_config.ignore_incompatible,</span>
<span class="line" id="L942">                                .opt_description = arg_description,</span>
<span class="line" id="L943">                            }) <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>);</span>
<span class="line" id="L944">                            opts_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L945">                            <span class="tok-kw">continue</span>;</span>
<span class="line" id="L946">                        }</span>
<span class="line" id="L947">                        from_vals[vals_idx] = (ValueT.from(field, .{</span>
<span class="line" id="L948">                            .ignore_incompatible = from_config.ignore_incompatible,</span>
<span class="line" id="L949">                            .val_name = arg_name,</span>
<span class="line" id="L950">                            .val_description = arg_description,</span>
<span class="line" id="L951">                        }) <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>);</span>
<span class="line" id="L952">                        vals_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L953">                    },</span>
<span class="line" id="L954">                    <span class="tok-comment">// Multi</span>
</span>
<span class="line" id="L955">                    .Array =&gt; |ary| {</span>
<span class="line" id="L956">                        <span class="tok-kw">const</span> ary_info = <span class="tok-builtin">@typeInfo</span>(ary.child);</span>
<span class="line" id="L957">                        <span class="tok-kw">switch</span> (ary_info) {</span>
<span class="line" id="L958">                            <span class="tok-comment">// Options</span>
</span>
<span class="line" id="L959">                            .Optional =&gt; {</span>
<span class="line" id="L960">                                from_opts[opts_idx] = OptionT.from(field, .{</span>
<span class="line" id="L961">                                    .name = arg_name,</span>
<span class="line" id="L962">                                    .short_name = <span class="tok-kw">if</span> (from_config.attempt_short_opts) optShortName(arg_name, short_names, &amp;short_idx) <span class="tok-kw">else</span> <span class="tok-null">null</span>, </span>
<span class="line" id="L963">                                    .long_name = arg_name,</span>
<span class="line" id="L964">                                    .ignore_incompatible = from_config.ignore_incompatible,</span>
<span class="line" id="L965">                                    .opt_description = arg_description</span>
<span class="line" id="L966">                                }) <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>;</span>
<span class="line" id="L967">                                opts_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L968">                            },</span>
<span class="line" id="L969">                            <span class="tok-comment">// Values</span>
</span>
<span class="line" id="L970">                            .Bool, .Int, .Float, .Pointer, .Enum =&gt; {</span>
<span class="line" id="L971">                                from_vals[vals_idx] = ValueT.from(field, .{</span>
<span class="line" id="L972">                                    .ignore_incompatible = from_config.ignore_incompatible,</span>
<span class="line" id="L973">                                    .val_name = arg_name,</span>
<span class="line" id="L974">                                    .val_description = arg_description</span>
<span class="line" id="L975">                                }) <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>;</span>
<span class="line" id="L976">                                vals_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L977">                            },</span>
<span class="line" id="L978">                            <span class="tok-kw">else</span> =&gt; <span class="tok-kw">if</span> (!from_config.ignore_incompatible) <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The field '&quot;</span> ++ field.name ++ <span class="tok-str">&quot;' of type 'Array' is incompatible. Arrays must contain one of the following types: Bool, Int, Float, Pointer (const u8), or their Optional counterparts.&quot;</span>),</span>
<span class="line" id="L979">                        }</span>
<span class="line" id="L980">                    },</span>
<span class="line" id="L981">                    <span class="tok-comment">// Incompatible</span>
</span>
<span class="line" id="L982">                    <span class="tok-kw">else</span> =&gt; <span class="tok-kw">if</span> (!from_config.ignore_incompatible) <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The field '&quot;</span> ++ field.name ++ <span class="tok-str">&quot;' of type '&quot;</span> ++ <span class="tok-builtin">@typeName</span>(field.<span class="tok-type">type</span>) ++ <span class="tok-str">&quot;' is incompatible as it cannot be converted to a Command, Option, or Value.&quot;</span>),</span>
<span class="line" id="L983">                }</span>
<span class="line" id="L984">            }</span>
<span class="line" id="L985"></span>
<span class="line" id="L986">            <span class="tok-kw">var</span> cmd_name_buf: [<span class="tok-builtin">@typeName</span>(FromT).len]<span class="tok-type">u8</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L987">            <span class="tok-kw">const</span> cmd_name = <span class="tok-kw">if</span> (from_config.cmd_name) |c_name| c_name <span class="tok-kw">else</span> cmdName: {</span>
<span class="line" id="L988">                <span class="tok-kw">if</span> (!from_config.convert_syntax) <span class="tok-kw">break</span> :cmdName <span class="tok-builtin">@typeName</span>(FromT) <span class="tok-kw">else</span> {</span>
<span class="line" id="L989">                    _ = mem.replace(<span class="tok-type">u8</span>, <span class="tok-builtin">@typeName</span>(FromT), <span class="tok-str">&quot;_&quot;</span>, <span class="tok-str">&quot;-&quot;</span>, cmd_name_buf[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L990">                    <span class="tok-kw">break</span> :cmdName cmd_name_buf[<span class="tok-number">0</span>..];</span>
<span class="line" id="L991">                }</span>
<span class="line" id="L992">            };</span>
<span class="line" id="L993">            <span class="tok-kw">return</span> <span class="tok-builtin">@This</span>(){</span>
<span class="line" id="L994">                .name = cmd_name,</span>
<span class="line" id="L995">                .alias_names = from_config.cmd_alias_names,</span>
<span class="line" id="L996">                .description = from_config.cmd_description,</span>
<span class="line" id="L997">                .hidden = from_config.cmd_hidden,</span>
<span class="line" id="L998">                .help_prefix = from_config.cmd_help_prefix,</span>
<span class="line" id="L999">                .cmd_groups = from_config.cmd_groups,</span>
<span class="line" id="L1000">                .cmd_group = from_config.cmd_group,</span>
<span class="line" id="L1001">                .sub_cmds = <span class="tok-kw">if</span> (cmds_idx &gt; <span class="tok-number">0</span>) from_cmds[<span class="tok-number">0</span>..cmds_idx] <span class="tok-kw">else</span> <span class="tok-null">null</span>,</span>
<span class="line" id="L1002">                .opts = <span class="tok-kw">if</span> (opts_idx &gt; <span class="tok-number">0</span>) from_opts[<span class="tok-number">0</span>..opts_idx] <span class="tok-kw">else</span> <span class="tok-null">null</span>,</span>
<span class="line" id="L1003">                .vals = <span class="tok-kw">if</span> (vals_idx &gt; <span class="tok-number">0</span>) from_vals[<span class="tok-number">0</span>..vals_idx] <span class="tok-kw">else</span> <span class="tok-null">null</span>,</span>
<span class="line" id="L1004">                .sub_cmds_mandatory = from_config.sub_cmds_mandatory,</span>
<span class="line" id="L1005">                .vals_mandatory = from_config.vals_mandatory,</span>
<span class="line" id="L1006">                .case_sensitive = from_config.case_sensitive,</span>
<span class="line" id="L1007">            };</span>
<span class="line" id="L1008">        }</span>
<span class="line" id="L1009">        <span class="tok-comment">/// Create a deconflicted Option short name from the provided `arg_name` and existing `short_names`.</span></span>
<span class="line" id="L1010">        <span class="tok-kw">fn</span> <span class="tok-fn">optShortName</span>(arg_name: []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, short_names: []<span class="tok-type">u8</span>, short_idx: *<span class="tok-type">u8</span>) ?<span class="tok-type">u8</span> {</span>
<span class="line" id="L1011">            <span class="tok-kw">return</span> shortName: {</span>
<span class="line" id="L1012">                <span class="tok-kw">for</span> (arg_name) |char| {</span>
<span class="line" id="L1013">                    <span class="tok-kw">const</span> ul_chars: [<span class="tok-number">2</span>]<span class="tok-type">u8</span> = .{ toLower(char), toUpper(char) };</span>
<span class="line" id="L1014">                    <span class="tok-kw">for</span> (ul_chars) |ul| {</span>
<span class="line" id="L1015">                        <span class="tok-kw">if</span> (short_idx.* &gt; <span class="tok-number">0</span> <span class="tok-kw">and</span> utils.indexOfEql(<span class="tok-type">u8</span>, short_names[<span class="tok-number">0</span>..short_idx.*], ul) != <span class="tok-null">null</span>) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L1016">                        short_names[short_idx.*] = ul;</span>
<span class="line" id="L1017">                        short_idx.* += <span class="tok-number">1</span>;</span>
<span class="line" id="L1018">                        <span class="tok-kw">break</span> :shortName ul;</span>
<span class="line" id="L1019">                    }</span>
<span class="line" id="L1020">                }</span>
<span class="line" id="L1021">                <span class="tok-kw">break</span> :shortName <span class="tok-null">null</span>;</span>
<span class="line" id="L1022">            };</span>
<span class="line" id="L1023">        }</span>
<span class="line" id="L1024"></span>
<span class="line" id="L1025">        <span class="tok-comment">/// Create a Command from the provided Function (`from_fn`).</span></span>
<span class="line" id="L1026">        <span class="tok-comment">/// The provided Function must be Comptime-known.</span></span>
<span class="line" id="L1027">        <span class="tok-comment">///</span></span>
<span class="line" id="L1028">        <span class="tok-comment">/// Types are converted as follows:</span></span>
<span class="line" id="L1029">        <span class="tok-comment">/// - Functions, Structs, Unions = Commands</span></span>
<span class="line" id="L1030">        <span class="tok-comment">/// - Valid Single-Parameters = Single-Values (Valid Values can be found under `Value.zig/Generic`.)</span></span>
<span class="line" id="L1031">        <span class="tok-comment">/// - Valid Array/Slice-Parameters = Multi-Values</span></span>
<span class="line" id="L1032">        <span class="tok-comment">/// - Note: Options can not be generated from Functions due to the lack of parameter names in `std.builtin.Type.Fn.Param`.</span></span>
<span class="line" id="L1033">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">fromFn</span>(<span class="tok-kw">comptime</span> FromFn: <span class="tok-type">type</span>, <span class="tok-kw">comptime</span> from_config: FromConfig) <span class="tok-builtin">@This</span>() {</span>
<span class="line" id="L1034">            <span class="tok-kw">const</span> from_info = <span class="tok-builtin">@typeInfo</span>(FromFn);</span>
<span class="line" id="L1035">            <span class="tok-kw">if</span> (from_info != .Fn) <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;Provided Type is not a Function.&quot;</span>);</span>
<span class="line" id="L1036"></span>
<span class="line" id="L1037">            <span class="tok-kw">var</span> from_cmds_buf: [from_config.max_cmds]<span class="tok-builtin">@This</span>() = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L1038">            <span class="tok-kw">const</span> from_cmds = from_cmds_buf[<span class="tok-number">0</span>..];</span>
<span class="line" id="L1039">            <span class="tok-kw">var</span> cmds_idx: <span class="tok-type">u8</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1040">            <span class="tok-kw">var</span> from_vals_buf: [from_config.max_vals]ValueT = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L1041">            <span class="tok-kw">const</span> from_vals = from_vals_buf[<span class="tok-number">0</span>..];</span>
<span class="line" id="L1042">            <span class="tok-kw">var</span> vals_idx: <span class="tok-type">u8</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1043"></span>
<span class="line" id="L1044">            <span class="tok-comment">//const arg_descriptions = ComptimeStringMap([]const u8, from_config.sub_descriptions);</span>
</span>
<span class="line" id="L1045"></span>
<span class="line" id="L1046">            <span class="tok-kw">const</span> params = from_info.Fn.params;</span>
<span class="line" id="L1047">            <span class="tok-kw">const</span> start_idx = <span class="tok-kw">if</span> (from_config.ignore_first) <span class="tok-number">1</span> <span class="tok-kw">else</span> <span class="tok-number">0</span>;</span>
<span class="line" id="L1048">            <span class="tok-kw">inline</span> <span class="tok-kw">for</span> (params[start_idx..]) |param| {</span>
<span class="line" id="L1049">                <span class="tok-kw">const</span> arg_description = <span class="tok-str">&quot;No description. (Descriptions cannot currently be generated from Function Parameters.)&quot;</span>;<span class="tok-comment">//arg_descriptions.get(param.name);</span>
</span>
<span class="line" id="L1050">                <span class="tok-comment">// Handle Argument Types.</span>
</span>
<span class="line" id="L1051">                <span class="tok-kw">switch</span> (<span class="tok-builtin">@typeInfo</span>(param.<span class="tok-type">type</span>.?)) {</span>
<span class="line" id="L1052">                    <span class="tok-comment">// Commands</span>
</span>
<span class="line" id="L1053">                    .Fn, .Struct, .Union =&gt; {</span>
<span class="line" id="L1054">                        <span class="tok-kw">const</span> sub_config = <span class="tok-kw">comptime</span> subConfig: {</span>
<span class="line" id="L1055">                            <span class="tok-kw">var</span> new_config = from_config;</span>
<span class="line" id="L1056">                            new_config.cmd_name = <span class="tok-str">&quot;cmd-&quot;</span> ++ &amp;.{ cmds_idx + <span class="tok-number">48</span> };</span>
<span class="line" id="L1057">                            new_config.cmd_description = arg_description <span class="tok-kw">orelse</span> <span class="tok-str">&quot;The '&quot;</span> ++ new_config.cmd_name ++ <span class="tok-str">&quot;' Command.&quot;</span>;</span>
<span class="line" id="L1058">                            <span class="tok-kw">break</span> :subConfig new_config;</span>
<span class="line" id="L1059">                        };</span>
<span class="line" id="L1060">                        from_cmds[cmds_idx] = from(param.<span class="tok-type">type</span>, sub_config);</span>
<span class="line" id="L1061">                        cmds_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L1062">                    },</span>
<span class="line" id="L1063">                    <span class="tok-comment">// Values</span>
</span>
<span class="line" id="L1064">                    .Bool, .Int, .Float, .Optional, .Pointer, .Enum =&gt; {</span>
<span class="line" id="L1065">                        from_vals[vals_idx] = (ValueT.from(param, .{</span>
<span class="line" id="L1066">                            .ignore_incompatible = from_config.ignore_incompatible,</span>
<span class="line" id="L1067">                            .val_name = <span class="tok-str">&quot;val-&quot;</span> ++ .{ <span class="tok-str">'0'</span>, (vals_idx + <span class="tok-number">48</span>), },</span>
<span class="line" id="L1068">                            .val_description = arg_description,</span>
<span class="line" id="L1069">                        }) <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>);</span>
<span class="line" id="L1070">                        vals_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L1071">                    },</span>
<span class="line" id="L1072">                    <span class="tok-comment">// Multi</span>
</span>
<span class="line" id="L1073">                    .Array =&gt; |ary| {</span>
<span class="line" id="L1074">                        <span class="tok-kw">const</span> ary_info = <span class="tok-builtin">@typeInfo</span>(ary.child);</span>
<span class="line" id="L1075">                        <span class="tok-kw">switch</span> (ary_info) {</span>
<span class="line" id="L1076">                            <span class="tok-comment">// Values</span>
</span>
<span class="line" id="L1077">                            .Bool, .Int, .Float, .Optional, .Pointer, .Enum =&gt; {</span>
<span class="line" id="L1078">                                from_vals[vals_idx] = ValueT.from(param, .{</span>
<span class="line" id="L1079">                                    .ignore_incompatible = from_config.ignore_incompatible,</span>
<span class="line" id="L1080">                                    .val_description = arg_description</span>
<span class="line" id="L1081">                                }) <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span>;</span>
<span class="line" id="L1082">                                vals_idx += <span class="tok-number">1</span>;</span>
<span class="line" id="L1083">                            },</span>
<span class="line" id="L1084">                            <span class="tok-kw">else</span> =&gt; <span class="tok-kw">if</span> (!from_config.ignore_incompatible) <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The parameter of type 'Array' is incompatible. Arrays must contain one of the following types: Bool, Int, Float, Pointer (const u8), or their Optional counterparts.&quot;</span>),</span>
<span class="line" id="L1085">                        }</span>
<span class="line" id="L1086">                    },</span>
<span class="line" id="L1087">                    <span class="tok-comment">// Incompatible</span>
</span>
<span class="line" id="L1088">                    <span class="tok-kw">else</span> =&gt; <span class="tok-kw">if</span> (!from_config.ignore_incompatible) <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The parameter of type '&quot;</span> ++ <span class="tok-builtin">@typeName</span>(param.<span class="tok-type">type</span>) ++ <span class="tok-str">&quot;' is incompatible as it cannot be converted to a Command or Value.&quot;</span>),</span>
<span class="line" id="L1089">                }</span>
<span class="line" id="L1090">            }</span>
<span class="line" id="L1091"></span>
<span class="line" id="L1092">            <span class="tok-kw">return</span> <span class="tok-builtin">@This</span>(){</span>
<span class="line" id="L1093">                .name = <span class="tok-kw">if</span> (from_config.cmd_name) |c_name| c_name <span class="tok-kw">else</span> <span class="tok-builtin">@typeName</span>(FromFn),</span>
<span class="line" id="L1094">                .alias_names = from_config.cmd_alias_names,</span>
<span class="line" id="L1095">                .description = from_config.cmd_description,</span>
<span class="line" id="L1096">                .hidden = from_config.cmd_hidden,</span>
<span class="line" id="L1097">                .cmd_groups = from_config.cmd_groups,</span>
<span class="line" id="L1098">                .cmd_group = from_config.cmd_group,</span>
<span class="line" id="L1099">                .help_prefix = from_config.cmd_help_prefix,</span>
<span class="line" id="L1100">                .sub_cmds = <span class="tok-kw">if</span> (cmds_idx &gt; <span class="tok-number">0</span>) from_cmds[<span class="tok-number">0</span>..cmds_idx] <span class="tok-kw">else</span> <span class="tok-null">null</span>,</span>
<span class="line" id="L1101">                .vals = <span class="tok-kw">if</span> (vals_idx &gt; <span class="tok-number">0</span>) from_vals[<span class="tok-number">0</span>..vals_idx] <span class="tok-kw">else</span> <span class="tok-null">null</span>,</span>
<span class="line" id="L1102">                .sub_cmds_mandatory = from_config.sub_cmds_mandatory,</span>
<span class="line" id="L1103">                .vals_mandatory = <span class="tok-null">true</span>,</span>
<span class="line" id="L1104">                .case_sensitive = from_config.case_sensitive,</span>
<span class="line" id="L1105">            };</span>
<span class="line" id="L1106">        }</span>
<span class="line" id="L1107"></span>
<span class="line" id="L1108">        <span class="tok-comment">/// Config for creating Structs from Commands using `to()`.</span></span>
<span class="line" id="L1109">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> ToConfig = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L1110">            <span class="tok-comment">/// Allow Unset Options and Values to be included.</span></span>
<span class="line" id="L1111">            <span class="tok-comment">/// When this is active, an attempt will be made to use the Struct's default value (if available) in the event of an Unset Option/Value.</span></span>
<span class="line" id="L1112">            allow_unset: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1113">            <span class="tok-comment">/// Ignore Incompatible types. Incompatible types are those that fall outside of the conversion rules listed under `from()`.</span></span>
<span class="line" id="L1114">            <span class="tok-comment">/// When this is active, an attempt will be made to use the Struct's default value (if available) in the event of an Incompatible type.</span></span>
<span class="line" id="L1115">            <span class="tok-comment">/// This will also allow Values to be set to sane defaults for Integers and Floats (0) as well as Strings (&quot;&quot;).</span></span>
<span class="line" id="L1116">            allow_incompatible: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1117">            <span class="tok-comment">/// Convert dashes '-' to underscores '_' in field names.</span></span>
<span class="line" id="L1118">            <span class="tok-comment">/// Be sure to set the counterpart to this flag in the `FromConfig` if this Command will be converted from a Struct or Union.</span></span>
<span class="line" id="L1119">            convert_syntax: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1120">            <span class="tok-comment">/// Allow Fields with a default value to come from Options or Values.</span></span>
<span class="line" id="L1121">            <span class="tok-comment">/// There's a corresponding field in the `FromConfig`.</span></span>
<span class="line" id="L1122">            default_val_opts: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1123">        };</span>
<span class="line" id="L1124"></span>
<span class="line" id="L1125">        <span class="tok-comment">/// Convert this Command to an instance of the provided Struct or Union Type (`toT`).</span></span>
<span class="line" id="L1126">        <span class="tok-comment">/// This is the inverse of `from()`.</span></span>
<span class="line" id="L1127">        <span class="tok-comment">///</span></span>
<span class="line" id="L1128">        <span class="tok-comment">/// Types are converted as follows:</span></span>
<span class="line" id="L1129">        <span class="tok-comment">/// - Commmands: Structs or Unions by recursively calling `to()`.</span></span>
<span class="line" id="L1130">        <span class="tok-comment">/// - Single-Options: Optional versions of Values.</span></span>
<span class="line" id="L1131">        <span class="tok-comment">/// - Single-Values: Booleans, Integers (Signed/Unsigned), and Pointers (`[]const u8`) only)</span></span>
<span class="line" id="L1132">        <span class="tok-comment">/// - Multi-Options/Values: Arrays of the corresponding Optionals or Values.</span></span>
<span class="line" id="L1133">        <span class="tok-comment">// TODO: Catch more error cases for incompatible types (i.e. Pointer not (`[]const u8`).</span>
</span>
<span class="line" id="L1134">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">to</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), <span class="tok-kw">comptime</span> ToT: <span class="tok-type">type</span>, to_config: ToConfig) !ToT {</span>
<span class="line" id="L1135">            <span class="tok-kw">const</span> alloc = self._alloc <span class="tok-kw">orelse</span> <span class="tok-kw">return</span> <span class="tok-kw">error</span>.CommandNotInitialized;</span>
<span class="line" id="L1136">            <span class="tok-kw">const</span> type_info = <span class="tok-builtin">@typeInfo</span>(ToT);</span>
<span class="line" id="L1137">            <span class="tok-kw">if</span> (type_info == .Union) { </span>
<span class="line" id="L1138">                <span class="tok-kw">const</span> vals_idx = <span class="tok-kw">if</span> (self.vals) |vals| valsIdx: {</span>
<span class="line" id="L1139">                    <span class="tok-kw">var</span> idx: <span class="tok-type">u8</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1140">                    <span class="tok-kw">for</span> (vals) |val| { <span class="tok-kw">if</span> (val.isSet()) idx += <span class="tok-number">1</span>; }</span>
<span class="line" id="L1141">                    <span class="tok-kw">break</span> :valsIdx idx;</span>
<span class="line" id="L1142">                } <span class="tok-kw">else</span> <span class="tok-number">0</span>;</span>
<span class="line" id="L1143">                <span class="tok-kw">const</span> opts_idx = <span class="tok-kw">if</span> (self.opts) |opts| optsIdx: {</span>
<span class="line" id="L1144">                    <span class="tok-kw">var</span> idx: <span class="tok-type">u8</span> = <span class="tok-number">0</span>;</span>
<span class="line" id="L1145">                    <span class="tok-kw">for</span> (opts) |opt| { </span>
<span class="line" id="L1146">                        <span class="tok-kw">if</span> (</span>
<span class="line" id="L1147">                            opt.val.isSet() <span class="tok-kw">and</span></span>
<span class="line" id="L1148">                            !mem.eql(<span class="tok-type">u8</span>, opt.name, <span class="tok-str">&quot;usage&quot;</span>) <span class="tok-kw">and</span></span>
<span class="line" id="L1149">                            !mem.eql(<span class="tok-type">u8</span>, opt.name, <span class="tok-str">&quot;help&quot;</span>)</span>
<span class="line" id="L1150">                        ) idx += <span class="tok-number">1</span>; </span>
<span class="line" id="L1151">                    }</span>
<span class="line" id="L1152">                    <span class="tok-kw">break</span> :optsIdx idx;</span>
<span class="line" id="L1153">                } <span class="tok-kw">else</span> <span class="tok-number">0</span>;</span>
<span class="line" id="L1154">                <span class="tok-kw">const</span> total_idx = vals_idx + opts_idx;</span>
<span class="line" id="L1155">                <span class="tok-kw">if</span> (total_idx &gt; <span class="tok-number">1</span>) { </span>
<span class="line" id="L1156">                    log.err(<span class="tok-str">&quot;Commands from Unions can only hold 1 Value or Option, but '{d}' were given.&quot;</span>, .{ total_idx });</span>
<span class="line" id="L1157">                    <span class="tok-kw">return</span> <span class="tok-kw">error</span>.ExpectedOnlyOneValOrOpt;</span>
<span class="line" id="L1158">                }</span>
<span class="line" id="L1159">            }</span>
<span class="line" id="L1160">            <span class="tok-kw">const</span> vals = getVals: {</span>
<span class="line" id="L1161">                <span class="tok-kw">var</span> valsList = std.ArrayList(ValueT).init(alloc);</span>
<span class="line" id="L1162">                <span class="tok-kw">try</span> valsList.appendSlice(self.vals <span class="tok-kw">orelse</span> &amp;.{});</span>
<span class="line" id="L1163">                <span class="tok-kw">if</span> (to_config.default_val_opts) optVals: {</span>
<span class="line" id="L1164">                    <span class="tok-kw">for</span> (self.opts <span class="tok-kw">orelse</span> <span class="tok-kw">break</span> :optVals) |opt| <span class="tok-kw">try</span> valsList.append(opt.val);</span>
<span class="line" id="L1165">                }</span>
<span class="line" id="L1166">                <span class="tok-kw">break</span> :getVals <span class="tok-kw">try</span> valsList.toOwnedSlice();</span>
<span class="line" id="L1167">            };</span>
<span class="line" id="L1168">            <span class="tok-kw">defer</span> alloc.free(vals);</span>
<span class="line" id="L1169">            <span class="tok-kw">var</span> out: ToT = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L1170">            <span class="tok-kw">const</span> fields = meta.fields(ToT);</span>
<span class="line" id="L1171">            <span class="tok-kw">inline</span> <span class="tok-kw">for</span> (fields) |field| {</span>
<span class="line" id="L1172">                <span class="tok-kw">if</span> (field.<span class="tok-type">type</span> == <span class="tok-builtin">@This</span>() <span class="tok-kw">or</span> field.<span class="tok-type">type</span> == OptionT <span class="tok-kw">or</span> field.<span class="tok-type">type</span> == ValueT) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L1173">                <span class="tok-kw">var</span> arg_name_buf: [field.name.len]<span class="tok-type">u8</span> = field.name[<span class="tok-number">0</span>..].*;</span>
<span class="line" id="L1174">                <span class="tok-kw">const</span> arg_name = <span class="tok-kw">if</span> (!to_config.convert_syntax) field.name <span class="tok-kw">else</span> argName: {</span>
<span class="line" id="L1175">                    _ = mem.replace(<span class="tok-type">u8</span>, field.name[<span class="tok-number">1</span>..], <span class="tok-str">&quot;_&quot;</span>, <span class="tok-str">&quot;-&quot;</span>, arg_name_buf[<span class="tok-number">1</span>..]);</span>
<span class="line" id="L1176">                    <span class="tok-kw">break</span> :argName arg_name_buf[<span class="tok-number">0</span>..];</span>
<span class="line" id="L1177">                };</span>
<span class="line" id="L1178">                <span class="tok-kw">const</span> field_info = <span class="tok-builtin">@typeInfo</span>(field.<span class="tok-type">type</span>);</span>
<span class="line" id="L1179">                <span class="tok-kw">switch</span> (field_info) {</span>
<span class="line" id="L1180">                    <span class="tok-comment">// Commands</span>
</span>
<span class="line" id="L1181">                    .Struct =&gt; {</span>
<span class="line" id="L1182">                        <span class="tok-builtin">@field</span>(out, field.name) = </span>
<span class="line" id="L1183">                            <span class="tok-kw">if</span> (self.sub_cmd != <span class="tok-null">null</span> <span class="tok-kw">and</span> mem.eql(<span class="tok-type">u8</span>, self.sub_cmd.?.name, arg_name))</span>
<span class="line" id="L1184">                                <span class="tok-kw">try</span> self.sub_cmd.?.to(field.<span class="tok-type">type</span>, to_config)</span>
<span class="line" id="L1185">                            <span class="tok-kw">else</span> <span class="tok-kw">if</span> (to_config.allow_unset) field.<span class="tok-type">type</span>{}</span>
<span class="line" id="L1186">                            <span class="tok-kw">else</span> <span class="tok-kw">return</span> <span class="tok-kw">error</span>.ValueNotSet;</span>
<span class="line" id="L1187">                    },</span>
<span class="line" id="L1188">                    .Union =&gt; <span class="tok-kw">if</span> (self.sub_cmd != <span class="tok-null">null</span> <span class="tok-kw">and</span> mem.eql(<span class="tok-type">u8</span>, self.sub_cmd.?.name, arg_name)) {</span>
<span class="line" id="L1189">                        <span class="tok-kw">return</span> <span class="tok-builtin">@unionInit</span>(ToT, field.name, <span class="tok-kw">try</span> self.sub_cmd.?.to(field.<span class="tok-type">type</span>, to_config));</span>
<span class="line" id="L1190">                    },</span>
<span class="line" id="L1191">                    <span class="tok-comment">// Options</span>
</span>
<span class="line" id="L1192">                    .Optional =&gt; |f_opt| <span class="tok-kw">if</span> (self.opts) |opts| {</span>
<span class="line" id="L1193">                        <span class="tok-kw">for</span> (opts) |opt| {</span>
<span class="line" id="L1194">                            <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, opt.name, arg_name)) {</span>
<span class="line" id="L1195">                                <span class="tok-kw">if</span> (!opt.val.isSet() <span class="tok-kw">and</span> type_info == .Struct) {</span>
<span class="line" id="L1196">                                    <span class="tok-kw">if</span> (!to_config.allow_unset) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.ValueNotSet;</span>
<span class="line" id="L1197">                                    <span class="tok-builtin">@field</span>(out, field.name) = </span>
<span class="line" id="L1198">                                        <span class="tok-kw">if</span> (field.default_value) |def_val| <span class="tok-builtin">@as</span>(*field.<span class="tok-type">type</span>, <span class="tok-builtin">@ptrCast</span>(<span class="tok-builtin">@alignCast</span>(<span class="tok-builtin">@constCast</span>(def_val)))).*</span>
<span class="line" id="L1199">                                        <span class="tok-kw">else</span> <span class="tok-null">null</span>;</span>
<span class="line" id="L1200">                                    <span class="tok-kw">break</span>;</span>
<span class="line" id="L1201">                                }</span>
<span class="line" id="L1202">                                <span class="tok-kw">if</span> (type_info == .Union) <span class="tok-kw">return</span> <span class="tok-builtin">@unionInit</span>(ToT, field.name, opt.val.getAs(f_opt.child) <span class="tok-kw">catch</span> <span class="tok-kw">continue</span>); </span>
<span class="line" id="L1203">                                <span class="tok-builtin">@field</span>(out, field.name) = <span class="tok-kw">try</span> opt.val.getAs(f_opt.child);</span>
<span class="line" id="L1204">                            }</span>
<span class="line" id="L1205">                        }</span>
<span class="line" id="L1206">                    },</span>
<span class="line" id="L1207">                    <span class="tok-comment">// Values</span>
</span>
<span class="line" id="L1208">                    .Bool, .Int, .Float, .Pointer, .Enum =&gt; {</span>
<span class="line" id="L1209">                        <span class="tok-kw">for</span> (vals) |val| {</span>
<span class="line" id="L1210">                            <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, val.name(), arg_name)) {</span>
<span class="line" id="L1211">                                <span class="tok-comment">//if (!val.isSet() and val.argIdx() == val.maxArgs() and type_info == .Struct) {</span>
</span>
<span class="line" id="L1212">                                <span class="tok-kw">if</span> (!val.isSet() <span class="tok-kw">and</span> type_info == .Struct) {</span>
<span class="line" id="L1213">                                    <span class="tok-kw">if</span> (!to_config.allow_unset) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.ValueNotSet;</span>
<span class="line" id="L1214">                                    <span class="tok-kw">const</span> def_val = field.default_value <span class="tok-kw">orelse</span> {</span>
<span class="line" id="L1215">                                        log.err(<span class="tok-str">&quot;The Field '{s}' has no default value.&quot;</span>, .{ field.name });</span>
<span class="line" id="L1216">                                        <span class="tok-kw">return</span> <span class="tok-kw">error</span>.NoDefaultValue;</span>
<span class="line" id="L1217">                                    };</span>
<span class="line" id="L1218">                                    <span class="tok-builtin">@field</span>(out, field.name) = <span class="tok-builtin">@as</span>(*field.<span class="tok-type">type</span>, <span class="tok-builtin">@ptrCast</span>(<span class="tok-builtin">@alignCast</span>(<span class="tok-builtin">@constCast</span>(def_val)))).*;</span>
<span class="line" id="L1219">                                    <span class="tok-kw">break</span>;</span>
<span class="line" id="L1220">                                }</span>
<span class="line" id="L1221">                                <span class="tok-kw">if</span> (type_info == .Union) <span class="tok-kw">return</span> <span class="tok-builtin">@unionInit</span>(ToT, field.name, val.getAs(field.<span class="tok-type">type</span>) <span class="tok-kw">catch</span> <span class="tok-kw">continue</span>); </span>
<span class="line" id="L1222">                                <span class="tok-builtin">@field</span>(out, field.name) = val.getAs(field.<span class="tok-type">type</span>) <span class="tok-kw">catch</span> |err| setVal: {</span>
<span class="line" id="L1223">                                    <span class="tok-kw">if</span> (!to_config.allow_incompatible) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.IncompatibleType;</span>
<span class="line" id="L1224">                                    <span class="tok-kw">break</span> :setVal <span class="tok-kw">switch</span> (field_info) {</span>
<span class="line" id="L1225">                                        .Bool =&gt; <span class="tok-null">false</span>,</span>
<span class="line" id="L1226">                                        .Int, .Float, =&gt; <span class="tok-builtin">@as</span>(field.<span class="tok-type">type</span>, <span class="tok-number">0</span>),</span>
<span class="line" id="L1227">                                        .Pointer =&gt; <span class="tok-str">&quot;&quot;</span>,    </span>
<span class="line" id="L1228">                                        <span class="tok-kw">else</span> =&gt; <span class="tok-kw">return</span> err,</span>
<span class="line" id="L1229">                                    };</span>
<span class="line" id="L1230">                                };</span>
<span class="line" id="L1231">                            }</span>
<span class="line" id="L1232">                        } </span>
<span class="line" id="L1233">                    },</span>
<span class="line" id="L1234">                    <span class="tok-comment">// Multi</span>
</span>
<span class="line" id="L1235">                    .Array =&gt; |ary| {</span>
<span class="line" id="L1236">                        <span class="tok-kw">const</span> ary_info = <span class="tok-builtin">@typeInfo</span>(ary.child);</span>
<span class="line" id="L1237">                        <span class="tok-kw">switch</span> (ary_info) {</span>
<span class="line" id="L1238">                            <span class="tok-comment">// - Options</span>
</span>
<span class="line" id="L1239">                            .Optional =&gt; |a_opt| <span class="tok-kw">if</span> (self.opts) |opts| {</span>
<span class="line" id="L1240">                                <span class="tok-kw">for</span> (opts) |opt| {</span>
<span class="line" id="L1241">                                    <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, opt.name, arg_name)) {</span>
<span class="line" id="L1242">                                        <span class="tok-kw">if</span> (!opt.val.isSet() <span class="tok-kw">and</span> type_info == .Struct) {</span>
<span class="line" id="L1243">                                            <span class="tok-kw">if</span> (!to_config.allow_unset) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.ValueNotSet;</span>
<span class="line" id="L1244">                                            <span class="tok-builtin">@field</span>(out, field.name) =</span>
<span class="line" id="L1245">                                                <span class="tok-kw">if</span> (field.default_value) |def_val|</span>
<span class="line" id="L1246">                                                    <span class="tok-builtin">@as</span>(*field.<span class="tok-type">type</span>, <span class="tok-builtin">@ptrCast</span>(<span class="tok-builtin">@alignCast</span>(<span class="tok-builtin">@constCast</span>(def_val)))).*</span>
<span class="line" id="L1247">                                                <span class="tok-kw">else</span> .{ <span class="tok-null">null</span> } ** ary.len;</span>
<span class="line" id="L1248">                                            <span class="tok-kw">break</span>;</span>
<span class="line" id="L1249">                                        }</span>
<span class="line" id="L1250">                                        <span class="tok-kw">const</span> val_tag = <span class="tok-kw">if</span> (a_opt.child == []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <span class="tok-str">&quot;string&quot;</span> <span class="tok-kw">else</span> <span class="tok-builtin">@typeName</span>(a_opt.child);</span>
<span class="line" id="L1251">                                        <span class="tok-kw">var</span> f_ary: field.<span class="tok-type">type</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L1252">                                        <span class="tok-kw">for</span> (f_ary[<span class="tok-number">0</span>..], <span class="tok-number">0</span>..) |*elm, idx| elm.* = <span class="tok-builtin">@field</span>(opt.val.generic, val_tag)._set_args[idx];</span>
<span class="line" id="L1253">                                        <span class="tok-kw">if</span> (type_info == .Union) <span class="tok-kw">return</span> <span class="tok-builtin">@unionInit</span>(ToT, field.name, f_ary); </span>
<span class="line" id="L1254">                                        <span class="tok-builtin">@field</span>(out, field.name) = f_ary;</span>
<span class="line" id="L1255">                                        <span class="tok-kw">break</span>;</span>
<span class="line" id="L1256">                                    }</span>
<span class="line" id="L1257">                                }</span>
<span class="line" id="L1258">                            },</span>
<span class="line" id="L1259">                            <span class="tok-comment">// - Values</span>
</span>
<span class="line" id="L1260">                            .Bool, .Int, .Float, .Pointer =&gt; {</span>
<span class="line" id="L1261">                                <span class="tok-kw">for</span> (vals) |val| {</span>
<span class="line" id="L1262">                                    <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, val.name(), arg_name)) {</span>
<span class="line" id="L1263">                                        <span class="tok-kw">if</span> (!val.isSet() <span class="tok-kw">and</span> val.argIdx() == val.maxArgs() <span class="tok-kw">and</span> type_info == .Struct) {</span>
<span class="line" id="L1264">                                            <span class="tok-kw">if</span> (!to_config.allow_unset) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.ValueNotSet;</span>
<span class="line" id="L1265">                                            <span class="tok-kw">const</span> def_val = field.default_value <span class="tok-kw">orelse</span> {</span>
<span class="line" id="L1266">                                                log.err(<span class="tok-str">&quot;The Field '{s}' has no default value.&quot;</span>, .{ field.name });</span>
<span class="line" id="L1267">                                                <span class="tok-kw">return</span> <span class="tok-kw">error</span>.NoDefaultValue;</span>
<span class="line" id="L1268">                                            };</span>
<span class="line" id="L1269">                                            <span class="tok-builtin">@field</span>(out, field.name) = <span class="tok-builtin">@as</span>(*field.<span class="tok-type">type</span>, <span class="tok-builtin">@ptrCast</span>(<span class="tok-builtin">@alignCast</span>(<span class="tok-builtin">@constCast</span>(def_val)))).*;</span>
<span class="line" id="L1270">                                            <span class="tok-kw">break</span>;</span>
<span class="line" id="L1271">                                        }</span>
<span class="line" id="L1272">                                        <span class="tok-kw">const</span> val_tag = <span class="tok-kw">if</span> (ary.child == []<span class="tok-kw">const</span> <span class="tok-type">u8</span>) <span class="tok-str">&quot;string&quot;</span> <span class="tok-kw">else</span> <span class="tok-builtin">@typeName</span>(ary.child);</span>
<span class="line" id="L1273">                                        <span class="tok-kw">var</span> f_ary: field.<span class="tok-type">type</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L1274">                                        <span class="tok-kw">for</span> (f_ary[<span class="tok-number">0</span>..], <span class="tok-number">0</span>..) |*elm, idx| elm.* = <span class="tok-builtin">@field</span>(val.generic, val_tag)._set_args[idx] <span class="tok-kw">orelse</span> elmVal: {</span>
<span class="line" id="L1275">                                            <span class="tok-kw">break</span> :elmVal <span class="tok-kw">switch</span> (ary_info) {</span>
<span class="line" id="L1276">                                                .Bool =&gt; <span class="tok-null">false</span>,</span>
<span class="line" id="L1277">                                                .Int, .Float, =&gt; <span class="tok-builtin">@as</span>(ary.child, <span class="tok-number">0</span>),</span>
<span class="line" id="L1278">                                                .Pointer =&gt; <span class="tok-str">&quot;&quot;</span>,    </span>
<span class="line" id="L1279">                                                <span class="tok-kw">else</span> =&gt; <span class="tok-kw">if</span> (!to_config.allow_incompatible) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.IncompatibleType,</span>
<span class="line" id="L1280">                                            };</span>
<span class="line" id="L1281">                                        };</span>
<span class="line" id="L1282">                                        <span class="tok-kw">if</span> (type_info == .Union) <span class="tok-kw">return</span> <span class="tok-builtin">@unionInit</span>(ToT, field.name, f_ary); </span>
<span class="line" id="L1283">                                        <span class="tok-builtin">@field</span>(out, field.name) = f_ary;</span>
<span class="line" id="L1284">                                        <span class="tok-kw">break</span>;</span>
<span class="line" id="L1285">                                    }</span>
<span class="line" id="L1286">                                } </span>
<span class="line" id="L1287">                            },</span>
<span class="line" id="L1288">                            <span class="tok-kw">else</span> =&gt; {</span>
<span class="line" id="L1289">                                <span class="tok-kw">if</span> (!to_config.allow_incompatible) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.IncompatibleType;</span>
<span class="line" id="L1290">                            },</span>
<span class="line" id="L1291">                        }</span>
<span class="line" id="L1292">                    },</span>
<span class="line" id="L1293">                    <span class="tok-kw">else</span> =&gt; {</span>
<span class="line" id="L1294">                        <span class="tok-kw">if</span> (!to_config.allow_incompatible) <span class="tok-kw">return</span> <span class="tok-kw">error</span>.IncompatibleType;</span>
<span class="line" id="L1295">                    },</span>
<span class="line" id="L1296">                }</span>
<span class="line" id="L1297">            }</span>
<span class="line" id="L1298">            <span class="tok-kw">return</span> out;</span>
<span class="line" id="L1299">        }</span>
<span class="line" id="L1300"></span>
<span class="line" id="L1301">        <span class="tok-comment">/// Call this Command as the provided Function (`call_fn`), returning the provided Return Type (`ReturnT`).</span></span>
<span class="line" id="L1302">        <span class="tok-comment">/// If the Return Type is an Error Union, this method expects only the payload Type.</span></span>
<span class="line" id="L1303">        <span class="tok-comment">/// If the Function has a `self` parameter it can be provided using (`fn_self`). </span></span>
<span class="line" id="L1304">        <span class="tok-comment">/// This effectively wraps the `@call()` builtin function by using this Command's Values as the function parameters.</span></span>
<span class="line" id="L1305">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">callAs</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), <span class="tok-kw">comptime</span> call_fn: <span class="tok-kw">anytype</span>, fn_self: <span class="tok-kw">anytype</span>, <span class="tok-kw">comptime</span> ReturnT: <span class="tok-type">type</span>) !ReturnT {</span>
<span class="line" id="L1306">            <span class="tok-kw">const</span> fn_info = <span class="tok-builtin">@typeInfo</span>(<span class="tok-builtin">@TypeOf</span>(call_fn));</span>
<span class="line" id="L1307">            <span class="tok-kw">const</span> fn_name = <span class="tok-builtin">@typeName</span>(<span class="tok-builtin">@TypeOf</span>(call_fn));</span>
<span class="line" id="L1308">            <span class="tok-kw">if</span> (fn_info != .Fn) {</span>
<span class="line" id="L1309">                log.err(<span class="tok-str">&quot;Expected a Function but received '{s}'.&quot;</span>, .{ fn_name });</span>
<span class="line" id="L1310">                <span class="tok-kw">return</span> <span class="tok-kw">error</span>.ExpectedFn;</span>
<span class="line" id="L1311">            }</span>
<span class="line" id="L1312">            <span class="tok-kw">if</span> (self.vals == <span class="tok-null">null</span> <span class="tok-kw">or</span> self.vals.?.len &lt; fn_info.Fn.params.len) {</span>
<span class="line" id="L1313">                log.err(<span class="tok-str">&quot;The provided function requires {d} parameters but only {d} was/were provided.&quot;</span>, .{ </span>
<span class="line" id="L1314">                    fn_info.Fn.params.len, </span>
<span class="line" id="L1315">                    <span class="tok-kw">if</span> (self.vals == <span class="tok-null">null</span>) <span class="tok-number">0</span> <span class="tok-kw">else</span> self.vals.?.len });</span>
<span class="line" id="L1316">                <span class="tok-kw">return</span> <span class="tok-kw">error</span>.ExpectedMoreParameters;</span>
<span class="line" id="L1317">            }</span>
<span class="line" id="L1318">            <span class="tok-kw">if</span> (fn_info.Fn.return_type.? != ReturnT) checkErrorUnion: {</span>
<span class="line" id="L1319">                <span class="tok-kw">const</span> return_info = <span class="tok-builtin">@typeInfo</span>(fn_info.Fn.return_type.?);</span>
<span class="line" id="L1320">                <span class="tok-kw">if</span> (return_info == .ErrorUnion <span class="tok-kw">and</span> return_info.ErrorUnion.payload == ReturnT) <span class="tok-kw">break</span> :checkErrorUnion;</span>
<span class="line" id="L1321">                log.err(<span class="tok-str">&quot;The return type of '{s}' does not match the provided return type '{s}'.&quot;</span>, .{ fn_name, <span class="tok-builtin">@typeName</span>(ReturnT) });</span>
<span class="line" id="L1322">                <span class="tok-kw">return</span> <span class="tok-kw">error</span>.ReturnTypeMismatch;</span>
<span class="line" id="L1323">            }</span>
<span class="line" id="L1324"></span>
<span class="line" id="L1325">            <span class="tok-kw">const</span> params = valsToParams: { </span>
<span class="line" id="L1326">                <span class="tok-kw">const</span> param_types = <span class="tok-kw">comptime</span> paramTypes: {</span>
<span class="line" id="L1327">                    <span class="tok-kw">var</span> types: [fn_info.Fn.params.len]<span class="tok-type">type</span> = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L1328">                    <span class="tok-kw">for</span> (types[<span class="tok-number">0</span>..], fn_info.Fn.params) |*T, param| T.* = param.<span class="tok-type">type</span>.?;</span>
<span class="line" id="L1329">                    <span class="tok-kw">break</span> :paramTypes types;</span>
<span class="line" id="L1330">                };</span>
<span class="line" id="L1331">                <span class="tok-kw">var</span> params_tuple: meta.Tuple(param_types[<span class="tok-number">0</span>..]) = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L1332">                <span class="tok-kw">const</span> start_idx = <span class="tok-kw">if</span> (<span class="tok-builtin">@TypeOf</span>(fn_self) == param_types[<span class="tok-number">0</span>]) <span class="tok-number">1</span> <span class="tok-kw">else</span> <span class="tok-number">0</span>;</span>
<span class="line" id="L1333">                <span class="tok-kw">if</span> (start_idx == <span class="tok-number">1</span>) params_tuple[<span class="tok-number">0</span>] = fn_self;</span>
<span class="line" id="L1334">                <span class="tok-kw">inline</span> <span class="tok-kw">for</span> (self.vals.?, &amp;params_tuple, <span class="tok-number">0</span>..) |val, *param, idx| {</span>
<span class="line" id="L1335">                    <span class="tok-kw">if</span> (idx &lt; start_idx) <span class="tok-kw">continue</span>;</span>
<span class="line" id="L1336">                    param.* = <span class="tok-kw">try</span> val.getAs(<span class="tok-builtin">@TypeOf</span>(param.*)); </span>
<span class="line" id="L1337">                }</span>
<span class="line" id="L1338">                </span>
<span class="line" id="L1339">                <span class="tok-kw">break</span> :valsToParams params_tuple;</span>
<span class="line" id="L1340">            };</span>
<span class="line" id="L1341"></span>
<span class="line" id="L1342">            <span class="tok-kw">return</span> <span class="tok-builtin">@call</span>(.auto, call_fn, params); </span>
<span class="line" id="L1343">        }</span>
<span class="line" id="L1344"></span>
<span class="line" id="L1345">        <span class="tok-comment">/// Create Sub Commands Enum.</span></span>
<span class="line" id="L1346">        <span class="tok-comment">/// This is useful for switching on the Sub Commands of this Command during analysis, but the Command (`self`) must be comptime-known.</span></span>
<span class="line" id="L1347">        <span class="tok-comment">/// Prefer to use `checkSubCmd`() and `matchSubCmd`() with conditional `if` statements.</span></span>
<span class="line" id="L1348">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">SubCommandsEnum</span>(<span class="tok-kw">comptime</span> self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>()) ?<span class="tok-type">type</span> {</span>
<span class="line" id="L1349">            <span class="tok-kw">if</span> (self.sub_cmds == <span class="tok-null">null</span>) <span class="tok-kw">return</span> <span class="tok-null">null</span>; <span class="tok-comment">//@compileError(&quot;Could not create Sub Commands Enum. This Command has no Sub Commands.&quot;);</span>
</span>
<span class="line" id="L1350">            <span class="tok-kw">var</span> cmd_fields: [self.sub_cmds.?.len]builtin.Type.EnumField = <span class="tok-null">undefined</span>;</span>
<span class="line" id="L1351">            <span class="tok-kw">for</span> (self.sub_cmds.?, cmd_fields[<span class="tok-number">0</span>..], <span class="tok-number">0</span>..) |cmd, *field, idx| {</span>
<span class="line" id="L1352">                field.* = .{</span>
<span class="line" id="L1353">                    .name = cmd.name,</span>
<span class="line" id="L1354">                    .value = idx,</span>
<span class="line" id="L1355">                };</span>
<span class="line" id="L1356">            }</span>
<span class="line" id="L1357">            <span class="tok-kw">return</span> <span class="tok-builtin">@Type</span>(builtin.Type{</span>
<span class="line" id="L1358">                .Enum = .{</span>
<span class="line" id="L1359">                    .tag_type = <span class="tok-type">u8</span>,</span>
<span class="line" id="L1360">                    .fields = cmd_fields[<span class="tok-number">0</span>..],</span>
<span class="line" id="L1361">                    .decls = &amp;.{},</span>
<span class="line" id="L1362">                    .is_exhaustive = <span class="tok-null">true</span>,</span>
<span class="line" id="L1363">                }</span>
<span class="line" id="L1364">            });</span>
<span class="line" id="L1365">        }</span>
<span class="line" id="L1366"></span>
<span class="line" id="L1367">        <span class="tok-comment">/// Config for the Validation of this Command.</span></span>
<span class="line" id="L1368">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> ValidateConfig = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L1369">            <span class="tok-comment">// Check Argument Groups to ensure they exist.</span>
</span>
<span class="line" id="L1370">            check_arg_groups: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1371">            <span class="tok-comment">// Check Command Alias Names to ensure they're distinct.</span>
</span>
<span class="line" id="L1372">            check_cmd_aliases: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1373">            <span class="tok-comment">// Check Option Alias Names to ensure they're distinct.</span>
</span>
<span class="line" id="L1374">            check_opt_aliases: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1375">            <span class="tok-comment">// Check for Usage/Help Commands</span>
</span>
<span class="line" id="L1376">            check_help_cmds: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1377">            <span class="tok-comment">// Check for Usage/Help Options</span>
</span>
<span class="line" id="L1378">            check_help_opts: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1379">        };</span>
<span class="line" id="L1380"></span>
<span class="line" id="L1381">        <span class="tok-comment">/// Validate this Command during Comptime using the provided ValidateConfig (`valid_config`).</span></span>
<span class="line" id="L1382">        <span class="tok-comment">/// This will check for:</span></span>
<span class="line" id="L1383">        <span class="tok-comment">///  - Distinct Sub Commands, Options, and Values</span></span>
<span class="line" id="L1384">        <span class="tok-comment">///  - Existing Argument Groups</span></span>
<span class="line" id="L1385">        <span class="tok-comment">///  - Distinct Command &amp; Option Alias Names.</span></span>
<span class="line" id="L1386">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">validate</span>(<span class="tok-kw">comptime</span> self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), <span class="tok-kw">comptime</span> valid_config: ValidateConfig) <span class="tok-type">void</span> {</span>
<span class="line" id="L1387">            <span class="tok-kw">comptime</span> {</span>
<span class="line" id="L1388">                <span class="tok-builtin">@setEvalBranchQuota</span>(<span class="tok-number">100_000</span>);</span>
<span class="line" id="L1389">                <span class="tok-kw">const</span> usage_help_strs = .{ <span class="tok-str">&quot;usage&quot;</span>, <span class="tok-str">&quot;help&quot;</span> } ++ (.{ <span class="tok-str">&quot;&quot;</span> } ** (max_args - <span class="tok-number">2</span>));</span>
<span class="line" id="L1390">                <span class="tok-comment">// Check for distinct Sub Commands and Validate them.</span>
</span>
<span class="line" id="L1391">                <span class="tok-kw">if</span> (self.sub_cmds) |cmds| {</span>
<span class="line" id="L1392">                    <span class="tok-kw">const</span> idx_offset: <span class="tok-type">u2</span> = <span class="tok-kw">if</span> (valid_config.check_help_cmds) <span class="tok-number">2</span> <span class="tok-kw">else</span> <span class="tok-number">0</span>;</span>
<span class="line" id="L1393">                    <span class="tok-kw">var</span> distinct_cmd: [max_args][]<span class="tok-kw">const</span> <span class="tok-type">u8</span> =</span>
<span class="line" id="L1394">                        <span class="tok-kw">if</span> (!valid_config.check_help_cmds) .{ <span class="tok-str">&quot;&quot;</span> } ** max_args</span>
<span class="line" id="L1395">                        <span class="tok-kw">else</span> usage_help_strs; </span>
<span class="line" id="L1396">                    <span class="tok-kw">for</span> (cmds, <span class="tok-number">0</span>..) |cmd, idx| {</span>
<span class="line" id="L1397">                        <span class="tok-kw">if</span> (self.case_sensitive <span class="tok-kw">and</span> utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, distinct_cmd[<span class="tok-number">0</span>..idx], cmd.name) != <span class="tok-null">null</span>) </span>
<span class="line" id="L1398">                            <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The Sub Command '&quot;</span> ++ cmd.name ++ <span class="tok-str">&quot;' is set more than once.&quot;</span>);</span>
<span class="line" id="L1399">                        <span class="tok-kw">if</span> (!self.case_sensitive <span class="tok-kw">and</span> utils.indexOfEqlIgnoreCase(distinct_cmd[<span class="tok-number">0</span>..idx], cmd.name) != <span class="tok-null">null</span>) </span>
<span class="line" id="L1400">                            <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The Sub Command '&quot;</span> ++ cmd.name ++ <span class="tok-str">&quot;' is set more than once.&quot;</span>);</span>
<span class="line" id="L1401">                        distinct_cmd[idx + idx_offset] = cmd.name;</span>
<span class="line" id="L1402">                    }</span>
<span class="line" id="L1403">                }</span>
<span class="line" id="L1404"></span>
<span class="line" id="L1405">                <span class="tok-comment">// Check for distinct Options.</span>
</span>
<span class="line" id="L1406">                <span class="tok-kw">if</span> (self.opts) |opts| {</span>
<span class="line" id="L1407">                    <span class="tok-kw">const</span> idx_offset: <span class="tok-type">u2</span> = <span class="tok-kw">if</span> (valid_config.check_help_cmds) <span class="tok-number">2</span> <span class="tok-kw">else</span> <span class="tok-number">0</span>;</span>
<span class="line" id="L1408">                    <span class="tok-kw">var</span> distinct_name: [max_args][]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = </span>
<span class="line" id="L1409">                        <span class="tok-kw">if</span> (!valid_config.check_help_opts) .{ <span class="tok-str">&quot;&quot;</span> } ** max_args</span>
<span class="line" id="L1410">                        <span class="tok-kw">else</span> usage_help_strs; </span>
<span class="line" id="L1411">                    <span class="tok-kw">var</span> distinct_short: [max_args]<span class="tok-type">u8</span> = </span>
<span class="line" id="L1412">                        <span class="tok-kw">if</span> (!valid_config.check_help_opts) .{ <span class="tok-str">' '</span> } ** max_args</span>
<span class="line" id="L1413">                        <span class="tok-kw">else</span> .{ <span class="tok-str">'u'</span>, <span class="tok-str">'h'</span> } ++ (.{ <span class="tok-str">' '</span> } ** (max_args - <span class="tok-number">2</span>));</span>
<span class="line" id="L1414">                    <span class="tok-kw">var</span> distinct_long: [max_args][]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = </span>
<span class="line" id="L1415">                        <span class="tok-kw">if</span> (!valid_config.check_help_opts) .{ <span class="tok-str">&quot;&quot;</span> } ** max_args</span>
<span class="line" id="L1416">                        <span class="tok-kw">else</span> usage_help_strs; </span>
<span class="line" id="L1417">                    <span class="tok-kw">for</span> (opts, <span class="tok-number">0</span>..) |opt, idx| {</span>
<span class="line" id="L1418">                        <span class="tok-kw">if</span> (utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, distinct_name[<span class="tok-number">0</span>..], opt.name) != <span class="tok-null">null</span>) </span>
<span class="line" id="L1419">                            <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The Option '&quot;</span> ++ opt.name ++ <span class="tok-str">&quot;' is set more than once.&quot;</span>);</span>
<span class="line" id="L1420">                        distinct_name[idx + idx_offset] = opt.name;</span>
<span class="line" id="L1421">                        <span class="tok-kw">if</span> (opt.short_name != <span class="tok-null">null</span> <span class="tok-kw">and</span> utils.indexOfEql(<span class="tok-type">u8</span>, distinct_short[<span class="tok-number">0</span>..], opt.short_name.?) != <span class="tok-null">null</span>) </span>
<span class="line" id="L1422">                            <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The Option Short Name '&quot;</span> ++ .{ opt.short_name.? } ++ <span class="tok-str">&quot;' is set more than once.&quot;</span>);</span>
<span class="line" id="L1423">                        distinct_short[idx + idx_offset] = opt.short_name <span class="tok-kw">orelse</span> <span class="tok-str">' '</span>;</span>
<span class="line" id="L1424">                        <span class="tok-kw">if</span> (opt.long_name) |long_name| {</span>
<span class="line" id="L1425">                            <span class="tok-kw">if</span> (</span>
<span class="line" id="L1426">                                (opt.case_sensitive <span class="tok-kw">and</span> utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, distinct_long[<span class="tok-number">0</span>..], long_name) != <span class="tok-null">null</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L1427">                                (!opt.case_sensitive <span class="tok-kw">and</span> utils.indexOfEqlIgnoreCase(distinct_long[<span class="tok-number">0</span>..], long_name) != <span class="tok-null">null</span>)</span>
<span class="line" id="L1428">                            ) <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The Option Long Name '&quot;</span> ++ long_name ++ <span class="tok-str">&quot;' is set more than once.&quot;</span>);</span>
<span class="line" id="L1429">                        }</span>
<span class="line" id="L1430">                        distinct_long[idx + idx_offset] = opt.long_name <span class="tok-kw">orelse</span> <span class="tok-str">&quot;a!garbage@long#name$&quot;</span>;</span>
<span class="line" id="L1431">                    }</span>
<span class="line" id="L1432">                }</span>
<span class="line" id="L1433"></span>
<span class="line" id="L1434">                <span class="tok-comment">// Check for distinct Values.</span>
</span>
<span class="line" id="L1435">                <span class="tok-kw">if</span> (self.vals) |vals| {</span>
<span class="line" id="L1436">                    <span class="tok-kw">var</span> distinct_val: [max_args][]<span class="tok-kw">const</span> <span class="tok-type">u8</span> = .{ <span class="tok-str">&quot;&quot;</span> } ** max_args;</span>
<span class="line" id="L1437">                    <span class="tok-kw">for</span> (vals, <span class="tok-number">0</span>..) |val, idx| {</span>
<span class="line" id="L1438">                        <span class="tok-kw">if</span> (utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, distinct_val[<span class="tok-number">0</span>..], val.name()) != <span class="tok-null">null</span>) </span>
<span class="line" id="L1439">                            <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The Value '&quot;</span> ++ val.name ++ <span class="tok-str">&quot;' is set more than once.&quot;</span>);</span>
<span class="line" id="L1440">                        distinct_val[idx] = val.name();</span>
<span class="line" id="L1441">                    }</span>
<span class="line" id="L1442">                }</span>
<span class="line" id="L1443"></span>
<span class="line" id="L1444">                <span class="tok-comment">// Check for existing Argument Groups.</span>
</span>
<span class="line" id="L1445">                <span class="tok-kw">if</span> (valid_config.check_arg_groups) {</span>
<span class="line" id="L1446">                    <span class="tok-comment">// - Command Groups.</span>
</span>
<span class="line" id="L1447">                    <span class="tok-kw">if</span> (self.sub_cmds) |cmds| cmdGroups: {</span>
<span class="line" id="L1448">                        <span class="tok-kw">const</span> groups = self.cmd_groups <span class="tok-kw">orelse</span> <span class="tok-kw">break</span> :cmdGroups;</span>
<span class="line" id="L1449">                        checkCmds: <span class="tok-kw">for</span> (cmds) |cmd| {</span>
<span class="line" id="L1450">                            <span class="tok-kw">if</span> (utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, groups, cmd.cmd_group <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :checkCmds) == <span class="tok-null">null</span>)</span>
<span class="line" id="L1451">                                <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The Command '&quot;</span> ++ cmd.name ++ <span class="tok-str">&quot;' has non-existent Group '&quot;</span> ++ cmd.cmd_group.? ++ <span class="tok-str">&quot;'.\n&quot;</span> ++ </span>
<span class="line" id="L1452">                                    <span class="tok-str">&quot;This validation check can be disabled using `Command.Custom.ValidateConfig.check_arg_groups`.&quot;</span>);</span>
<span class="line" id="L1453">                        }</span>
<span class="line" id="L1454">                    }</span>
<span class="line" id="L1455">                    <span class="tok-comment">// - Option Groups.</span>
</span>
<span class="line" id="L1456">                    <span class="tok-kw">if</span> (self.opts) |opts| optGroups: {</span>
<span class="line" id="L1457">                        <span class="tok-kw">const</span> groups = self.opt_groups <span class="tok-kw">orelse</span> <span class="tok-kw">break</span> :optGroups;</span>
<span class="line" id="L1458">                        checkCmds: <span class="tok-kw">for</span> (opts) |opt| {</span>
<span class="line" id="L1459">                            <span class="tok-kw">if</span> (utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, groups, opt.opt_group <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :checkCmds) == <span class="tok-null">null</span>)</span>
<span class="line" id="L1460">                                <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The Option '&quot;</span> ++ opt.name ++ <span class="tok-str">&quot;' has non-existent Group '&quot;</span> ++ opt.opt_group.? ++ <span class="tok-str">&quot;'.\n&quot;</span> ++</span>
<span class="line" id="L1461">                                    <span class="tok-str">&quot;This validation check can be disabled using `Command.Custom.ValidateConfig.check_arg_groups`.&quot;</span>);</span>
<span class="line" id="L1462">                        }</span>
<span class="line" id="L1463">                    }</span>
<span class="line" id="L1464">                    <span class="tok-comment">// - Mandatory Option Groups.</span>
</span>
<span class="line" id="L1465">                    <span class="tok-kw">if</span> (self.mandatory_opt_groups) |man_groups| {</span>
<span class="line" id="L1466">                        <span class="tok-kw">if</span> (self.opt_groups) |groups| {</span>
<span class="line" id="L1467">                            <span class="tok-kw">for</span> (man_groups) |man_group| {</span>
<span class="line" id="L1468">                                <span class="tok-kw">if</span> (utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, groups, man_group) == <span class="tok-null">null</span>)</span>
<span class="line" id="L1469">                                    <span class="tok-builtin">@compileError</span>(fmt.comptimePrint(<span class="tok-str">&quot;The Mandatory Option Group {s} is not in the given Option Groups.&quot;</span>, .{ man_group }));</span>
<span class="line" id="L1470">                            }</span>
<span class="line" id="L1471">                        }</span>
<span class="line" id="L1472">                        <span class="tok-kw">else</span> <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;Mandatory Option Groups must be a subset of Option Groups but no Option Groups were given.&quot;</span>);</span>
<span class="line" id="L1473">                    }</span>
<span class="line" id="L1474">                    <span class="tok-comment">// - Value Groups.</span>
</span>
<span class="line" id="L1475">                    <span class="tok-kw">if</span> (self.vals) |vals| valGroups: {</span>
<span class="line" id="L1476">                        <span class="tok-kw">const</span> groups = self.val_groups <span class="tok-kw">orelse</span> <span class="tok-kw">break</span> :valGroups;</span>
<span class="line" id="L1477">                        checkCmds: <span class="tok-kw">for</span> (vals) |val| {</span>
<span class="line" id="L1478">                            <span class="tok-kw">if</span> (utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, groups, val.valGroup() <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :checkCmds) == <span class="tok-null">null</span>)</span>
<span class="line" id="L1479">                                <span class="tok-builtin">@compileError</span>(<span class="tok-str">&quot;The Value '&quot;</span> ++ val.name() ++ <span class="tok-str">&quot;' has non-existent Group '&quot;</span> ++ val.valGroup.? ++ <span class="tok-str">&quot;'.\n&quot;</span> ++</span>
<span class="line" id="L1480">                                    <span class="tok-str">&quot;This validation check can be disabled using `Command.Custom.ValidateConfig.check_arg_groups`.&quot;</span>);</span>
<span class="line" id="L1481">                        }</span>
<span class="line" id="L1482">                    }</span>
<span class="line" id="L1483">                }</span>
<span class="line" id="L1484"></span>
<span class="line" id="L1485">                <span class="tok-comment">// Check for Distinct Command Alias Names.</span>
</span>
<span class="line" id="L1486">                <span class="tok-kw">if</span> (valid_config.check_cmd_aliases) distinctAliases: {</span>
<span class="line" id="L1487">                    <span class="tok-kw">const</span> cmds = self.sub_cmds <span class="tok-kw">orelse</span> <span class="tok-kw">break</span> :distinctAliases;</span>
<span class="line" id="L1488">                    checkCmds1: <span class="tok-kw">for</span> (cmds) |cmd_1| {</span>
<span class="line" id="L1489">                        checkCmds2: <span class="tok-kw">for</span> (cmds) |cmd_2| {</span>
<span class="line" id="L1490">                            <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, cmd_1.name, cmd_2.name)) <span class="tok-kw">continue</span> :checkCmds2;</span>
<span class="line" id="L1491">                            checkAliases: <span class="tok-kw">for</span> (cmd_1.alias_names <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :checkCmds1) |alias| {</span>
<span class="line" id="L1492">                                <span class="tok-kw">const</span> case_sense = cmd_1.case_sensitive <span class="tok-kw">or</span> cmd_2.case_sensitive; </span>
<span class="line" id="L1493">                                <span class="tok-kw">if</span> (</span>
<span class="line" id="L1494">                                    (case_sense <span class="tok-kw">and</span> mem.eql(<span class="tok-type">u8</span>, cmd_2.name, alias)) <span class="tok-kw">or</span></span>
<span class="line" id="L1495">                                    (!case_sense <span class="tok-kw">and</span> ascii.eqlIgnoreCase(cmd_2.name, alias))</span>
<span class="line" id="L1496">                                )</span>
<span class="line" id="L1497">                                    <span class="tok-builtin">@compileError</span>(</span>
<span class="line" id="L1498">                                        <span class="tok-str">&quot;The Command '&quot;</span> ++ cmd_1.name ++ <span class="tok-str">&quot;' has Alias '&quot;</span> ++ alias ++ <span class="tok-str">&quot;' which overshadows the Command '&quot;</span> ++ </span>
<span class="line" id="L1499">                                        cmd_2.name ++ <span class="tok-str">&quot;'.\n&quot;</span> ++ </span>
<span class="line" id="L1500">                                        <span class="tok-str">&quot;This validation check can be disabled using `Command.Custom.ValidateConfig.check_cmd_aliases`.&quot;</span></span>
<span class="line" id="L1501">                                    );</span>
<span class="line" id="L1502">                                <span class="tok-kw">if</span> (</span>
<span class="line" id="L1503">                                    (case_sense <span class="tok-kw">and</span> utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, cmd_2.alias_names <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :checkAliases, alias) != <span class="tok-null">null</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L1504">                                    (!case_sense <span class="tok-kw">and</span> utils.indexOfEqlIgnoreCase(cmd_2.alias_names <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :checkAliases, alias) != <span class="tok-null">null</span>)</span>
<span class="line" id="L1505">                                )</span>
<span class="line" id="L1506">                                    <span class="tok-builtin">@compileError</span>(</span>
<span class="line" id="L1507">                                        <span class="tok-str">&quot;The Command '&quot;</span> ++ cmd_1.name ++ <span class="tok-str">&quot;' has Alias '&quot;</span> ++ alias ++ <span class="tok-str">&quot;' which overshadows an Alias of the Command '&quot;</span> ++ </span>
<span class="line" id="L1508">                                        cmd_2.name ++ <span class="tok-str">&quot;'.\n&quot;</span> ++ </span>
<span class="line" id="L1509">                                        <span class="tok-str">&quot;This validation check can be disabled using `Command.Custom.ValidateConfig.check_cmd_aliases`.&quot;</span></span>
<span class="line" id="L1510">                                    );</span>
<span class="line" id="L1511">                            }</span>
<span class="line" id="L1512">                        }</span>
<span class="line" id="L1513">                    }</span>
<span class="line" id="L1514">                }</span>
<span class="line" id="L1515">                <span class="tok-comment">// Check for Distinct Option Alias Long Names.</span>
</span>
<span class="line" id="L1516">                <span class="tok-kw">if</span> (valid_config.check_opt_aliases) distinctAliases: {</span>
<span class="line" id="L1517">                    <span class="tok-kw">const</span> opts = self.opts <span class="tok-kw">orelse</span> <span class="tok-kw">break</span> :distinctAliases;</span>
<span class="line" id="L1518">                    checkCmds1: <span class="tok-kw">for</span> (opts) |opt_1| {</span>
<span class="line" id="L1519">                        <span class="tok-kw">const</span> opt_1_ln = opt_1.long_name <span class="tok-kw">orelse</span> {</span>
<span class="line" id="L1520">                            <span class="tok-kw">if</span> (opt_1.alias_long_names) |_| <span class="tok-builtin">@compileError</span>(fmt.comptimePrint(<span class="tok-str">&quot;The Option {s} has aliases but no long name.&quot;</span>, .{ opt_1.name }));</span>
<span class="line" id="L1521">                            <span class="tok-kw">continue</span> :checkCmds1;</span>
<span class="line" id="L1522">                        };</span>
<span class="line" id="L1523">                        checkCmds2: <span class="tok-kw">for</span> (opts) |opt_2| {</span>
<span class="line" id="L1524">                            <span class="tok-kw">const</span> opt_2_ln = opt_2.long_name <span class="tok-kw">orelse</span> {</span>
<span class="line" id="L1525">                                <span class="tok-kw">if</span> (opt_2.alias_long_names) |_| <span class="tok-builtin">@compileError</span>(fmt.comptimePrint(<span class="tok-str">&quot;The Option {s} has aliases but no long name.&quot;</span>, .{ opt_2.name }));</span>
<span class="line" id="L1526">                                <span class="tok-kw">continue</span> :checkCmds2;</span>
<span class="line" id="L1527">                            };</span>
<span class="line" id="L1528">                            <span class="tok-kw">if</span> (mem.eql(<span class="tok-type">u8</span>, opt_1_ln, opt_2_ln)) <span class="tok-kw">continue</span> :checkCmds2;</span>
<span class="line" id="L1529">                            checkAliases: <span class="tok-kw">for</span> (opt_1.alias_long_names <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :checkCmds1) |alias| {</span>
<span class="line" id="L1530">                                <span class="tok-kw">const</span> case_sense = opt_1.case_sensitive <span class="tok-kw">or</span> opt_2.case_sensitive; </span>
<span class="line" id="L1531">                                <span class="tok-kw">if</span> (</span>
<span class="line" id="L1532">                                    (case_sense <span class="tok-kw">and</span> mem.eql(<span class="tok-type">u8</span>, opt_2_ln, alias)) <span class="tok-kw">or</span></span>
<span class="line" id="L1533">                                    (!case_sense <span class="tok-kw">and</span> ascii.eqlIgnoreCase(opt_2_ln, alias))</span>
<span class="line" id="L1534">                                )</span>
<span class="line" id="L1535">                                    <span class="tok-builtin">@compileError</span>(</span>
<span class="line" id="L1536">                                        <span class="tok-str">&quot;The Option '&quot;</span> ++ opt_1.name ++ <span class="tok-str">&quot;' has Alias '&quot;</span> ++ alias ++ <span class="tok-str">&quot;' which overshadows the Option '&quot;</span> ++ </span>
<span class="line" id="L1537">                                        opt_2_ln ++ <span class="tok-str">&quot;'.\n&quot;</span> ++ </span>
<span class="line" id="L1538">                                        <span class="tok-str">&quot;This validation check can be disabled using `Command.Custom.ValidateConfig.check_opt_aliases`.&quot;</span></span>
<span class="line" id="L1539">                                    );</span>
<span class="line" id="L1540">                                <span class="tok-kw">if</span> (</span>
<span class="line" id="L1541">                                    (case_sense <span class="tok-kw">and</span> utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, opt_2.alias_long_names <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :checkAliases, alias) != <span class="tok-null">null</span>) <span class="tok-kw">or</span></span>
<span class="line" id="L1542">                                    (!case_sense <span class="tok-kw">and</span> utils.indexOfEqlIgnoreCase(opt_2.alias_long_names <span class="tok-kw">orelse</span> <span class="tok-kw">continue</span> :checkAliases, alias) != <span class="tok-null">null</span>)</span>
<span class="line" id="L1543">                                )</span>
<span class="line" id="L1544">                                    <span class="tok-builtin">@compileError</span>(</span>
<span class="line" id="L1545">                                        <span class="tok-str">&quot;The Option '&quot;</span> ++ opt_1.name ++ <span class="tok-str">&quot;' has Alias '&quot;</span> ++ alias ++ <span class="tok-str">&quot;' which overshadows an Alias of the Option '&quot;</span> ++ </span>
<span class="line" id="L1546">                                        opt_2.name ++ <span class="tok-str">&quot;'.\n&quot;</span> ++ </span>
<span class="line" id="L1547">                                        <span class="tok-str">&quot;This validation check can be disabled using `Command.Custom.ValidateConfig.check_opt_aliases`.&quot;</span></span>
<span class="line" id="L1548">                                    );</span>
<span class="line" id="L1549">                            }</span>
<span class="line" id="L1550">                        }</span>
<span class="line" id="L1551">                    }</span>
<span class="line" id="L1552">                }</span>
<span class="line" id="L1553">            }</span>
<span class="line" id="L1554">        }</span>
<span class="line" id="L1555"></span>
<span class="line" id="L1556">        <span class="tok-comment">/// Config for the Initialization of this Command.</span></span>
<span class="line" id="L1557">        <span class="tok-kw">pub</span> <span class="tok-kw">const</span> InitConfig = <span class="tok-kw">struct</span> {</span>
<span class="line" id="L1558">            <span class="tok-comment">/// Validate this Command.</span></span>
<span class="line" id="L1559">            validate_cmd: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1560">            <span class="tok-comment">/// Validation Config</span></span>
<span class="line" id="L1561">            valid_config: ValidateConfig = .{},</span>
<span class="line" id="L1562">            <span class="tok-comment">/// Add Usage/Help message Commands to this Command.</span></span>
<span class="line" id="L1563">            add_help_cmds: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1564">            <span class="tok-comment">/// Add Usage/Help message Options to this Command.</span></span>
<span class="line" id="L1565">            add_help_opts: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1566">            <span class="tok-comment">/// Add Help Argument Group for Usage/Help Commands.</span></span>
<span class="line" id="L1567">            <span class="tok-comment">/// Note, this will only take effect if `add_help_cmds` is `true`.</span></span>
<span class="line" id="L1568">            add_cmd_help_group: AddHelpGroup = .AddIfOthers,</span>
<span class="line" id="L1569">            <span class="tok-comment">/// Add Help Argument Group for Usage/Help Options.</span></span>
<span class="line" id="L1570">            <span class="tok-comment">/// Note, this will only take effect if `add_help_opts` is `true`.</span></span>
<span class="line" id="L1571">            add_opt_help_group: AddHelpGroup = .AddIfOthers,</span>
<span class="line" id="L1572">            <span class="tok-comment">/// Help Argument Group Name.</span></span>
<span class="line" id="L1573">            help_group_name: []<span class="tok-kw">const</span> <span class="tok-type">u8</span> = <span class="tok-str">&quot;HELP&quot;</span>,</span>
<span class="line" id="L1574">            <span class="tok-comment">/// Initialize this Command's Sub Commands.</span></span>
<span class="line" id="L1575">            init_subcmds: <span class="tok-type">bool</span> = <span class="tok-null">true</span>,</span>
<span class="line" id="L1576"></span>
<span class="line" id="L1577">            <span class="tok-comment">/// Determine behavior for adding a Help Argument Group.</span></span>
<span class="line" id="L1578">            <span class="tok-kw">pub</span> <span class="tok-kw">const</span> AddHelpGroup = <span class="tok-kw">enum</span>{</span>
<span class="line" id="L1579">                <span class="tok-comment">/// Add if there are other Argument Groups.</span></span>
<span class="line" id="L1580">                AddIfOthers,</span>
<span class="line" id="L1581">                <span class="tok-comment">/// Add regardless of other Argument Groups.</span></span>
<span class="line" id="L1582">                Add,</span>
<span class="line" id="L1583">                <span class="tok-comment">/// Do not add.</span></span>
<span class="line" id="L1584">                DoNotAdd,</span>
<span class="line" id="L1585">            };</span>
<span class="line" id="L1586">        };</span>
<span class="line" id="L1587"></span>
<span class="line" id="L1588">        <span class="tok-comment">/// Initialize this Command with the provided InitConfig (`init_config`) by duplicating it with the provided Allocator (`alloc`) for Runtime use.</span></span>
<span class="line" id="L1589">        <span class="tok-comment">/// This should be used after this Command has been created in Comptime.</span></span>
<span class="line" id="L1590">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">init</span>(<span class="tok-kw">comptime</span> self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(), alloc: mem.Allocator, <span class="tok-kw">comptime</span> init_config: InitConfig) !*<span class="tok-builtin">@This</span>() {</span>
<span class="line" id="L1591">            <span class="tok-kw">return</span> self.initCtx(init_config, <span class="tok-null">true</span>, <span class="tok-null">null</span>, alloc);</span>
<span class="line" id="L1592">        }</span>
<span class="line" id="L1593"></span>
<span class="line" id="L1594">        <span class="tok-comment">/// Initialize Recursively with Context (`is_root_cmd`).</span></span>
<span class="line" id="L1595">        <span class="tok-comment">/// *INTERNAL USE*</span></span>
<span class="line" id="L1596">        <span class="tok-kw">fn</span> <span class="tok-fn">initCtx</span>(</span>
<span class="line" id="L1597">            <span class="tok-kw">comptime</span> self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(),</span>
<span class="line" id="L1598">            <span class="tok-kw">comptime</span> init_config: InitConfig,</span>
<span class="line" id="L1599">            <span class="tok-kw">comptime</span> is_root_cmd: <span class="tok-type">bool</span>,</span>
<span class="line" id="L1600">            parent_cmd: ?*<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>(),</span>
<span class="line" id="L1601">            init_alloc: mem.Allocator</span>
<span class="line" id="L1602">        ) !<span class="tok-kw">if</span> (is_root_cmd) *<span class="tok-builtin">@This</span>() <span class="tok-kw">else</span> <span class="tok-builtin">@This</span>() {</span>
<span class="line" id="L1603">            <span class="tok-kw">if</span> (init_config.validate_cmd) {</span>
<span class="line" id="L1604">                <span class="tok-kw">comptime</span> <span class="tok-kw">var</span> valid_config = init_config.valid_config;</span>
<span class="line" id="L1605">                valid_config.check_help_cmds = init_config.add_help_cmds;</span>
<span class="line" id="L1606">                valid_config.check_help_opts = init_config.add_help_opts;</span>
<span class="line" id="L1607">                self.validate(valid_config);</span>
<span class="line" id="L1608">            }</span>
<span class="line" id="L1609"></span>
<span class="line" id="L1610">            <span class="tok-kw">var</span> init_cmd,</span>
<span class="line" id="L1611">            <span class="tok-kw">const</span> alloc = setup: {</span>
<span class="line" id="L1612">                <span class="tok-kw">var</span> cmd = <span class="tok-kw">try</span> init_alloc.create(<span class="tok-builtin">@This</span>());</span>
<span class="line" id="L1613">                cmd.* = self.*;</span>
<span class="line" id="L1614">                <span class="tok-kw">if</span> (is_root_cmd) {</span>
<span class="line" id="L1615">                    cmd._root_alloc = init_alloc;</span>
<span class="line" id="L1616">                    cmd._arena = heap.ArenaAllocator.init(init_alloc);</span>
<span class="line" id="L1617">                    cmd._alloc = cmd._arena.?.allocator();</span>
<span class="line" id="L1618">                }</span>
<span class="line" id="L1619">                <span class="tok-kw">else</span> cmd._alloc = init_alloc;</span>
<span class="line" id="L1620">                <span class="tok-kw">break</span> :setup .{ cmd, cmd._alloc.? };</span>
<span class="line" id="L1621">            };</span>
<span class="line" id="L1622">            init_cmd.parent_cmd = parent_cmd;</span>
<span class="line" id="L1623"></span>
<span class="line" id="L1624">            <span class="tok-comment">// This implementation doesn't support `parent_cmd` pointers.</span>
</span>
<span class="line" id="L1625">            <span class="tok-comment">//var init_cmd: if (is_root_cmd) *@This() else @This(),</span>
</span>
<span class="line" id="L1626">            <span class="tok-comment">//const alloc = setup: {</span>
</span>
<span class="line" id="L1627">            <span class="tok-comment">//    const cmd = if (is_root_cmd) rootCmd: {</span>
</span>
<span class="line" id="L1628">            <span class="tok-comment">//        const root_cmd = try init_alloc.create(@This());</span>
</span>
<span class="line" id="L1629">            <span class="tok-comment">//        root_cmd.* = self.*;</span>
</span>
<span class="line" id="L1630">            <span class="tok-comment">//        root_cmd._root_alloc = init_alloc;</span>
</span>
<span class="line" id="L1631">            <span class="tok-comment">//        root_cmd._arena = heap.ArenaAllocator.init(init_alloc);</span>
</span>
<span class="line" id="L1632">            <span class="tok-comment">//        root_cmd._alloc = root_cmd._arena.?.allocator();</span>
</span>
<span class="line" id="L1633">            <span class="tok-comment">//        break :rootCmd root_cmd;</span>
</span>
<span class="line" id="L1634">            <span class="tok-comment">//    }</span>
</span>
<span class="line" id="L1635">            <span class="tok-comment">//    else childCmd: {</span>
</span>
<span class="line" id="L1636">            <span class="tok-comment">//        var child_cmd = self.*;</span>
</span>
<span class="line" id="L1637">            <span class="tok-comment">//        child_cmd._alloc = init_alloc;</span>
</span>
<span class="line" id="L1638">            <span class="tok-comment">//        break :childCmd child_cmd;</span>
</span>
<span class="line" id="L1639">            <span class="tok-comment">//    };</span>
</span>
<span class="line" id="L1640">            <span class="tok-comment">//    break :setup .{ cmd, cmd._alloc.? };</span>
</span>
<span class="line" id="L1641">            <span class="tok-comment">//};</span>
</span>
<span class="line" id="L1642">            <span class="tok-comment">//init_cmd.parent_cmd = parent_cmd;</span>
</span>
<span class="line" id="L1643"></span>
<span class="line" id="L1644">            <span class="tok-kw">const</span> usage_description = fmt.comptimePrint(<span class="tok-str">&quot;Show the '{s}' usage display.&quot;</span>, .{ self.name });</span>
<span class="line" id="L1645">            <span class="tok-kw">const</span> help_description = fmt.comptimePrint(<span class="tok-str">&quot;Show the '{s}' help display.&quot;</span>, .{ self.name });</span>
<span class="line" id="L1646"></span>
<span class="line" id="L1647">            <span class="tok-kw">if</span> (init_config.add_help_cmds <span class="tok-kw">and</span> (utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, &amp;.{ <span class="tok-str">&quot;help&quot;</span>, <span class="tok-str">&quot;usage&quot;</span> }, self.name) == <span class="tok-null">null</span>)) {</span>
<span class="line" id="L1648">                <span class="tok-kw">const</span> add_cmd_help_group = <span class="tok-kw">switch</span> (init_config.add_cmd_help_group) {</span>
<span class="line" id="L1649">                    .AddIfOthers =&gt; ifOthers: {</span>
<span class="line" id="L1650">                        <span class="tok-kw">if</span> (init_cmd.cmd_groups) |cmd_groups| {</span>
<span class="line" id="L1651">                            init_cmd.cmd_groups = <span class="tok-kw">try</span> mem.concat(alloc, []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, &amp;.{ cmd_groups, &amp;.{ init_config.help_group_name } });</span>
<span class="line" id="L1652">                            <span class="tok-kw">break</span> :ifOthers <span class="tok-null">true</span>;</span>
<span class="line" id="L1653">                        }</span>
<span class="line" id="L1654">                        <span class="tok-kw">break</span> :ifOthers <span class="tok-null">false</span>;</span>
<span class="line" id="L1655">                    },</span>
<span class="line" id="L1656">                    .Add =&gt; add: {</span>
<span class="line" id="L1657">                        init_cmd.cmd_groups = </span>
<span class="line" id="L1658">                            <span class="tok-kw">if</span> (init_cmd.cmd_groups) |cmd_groups| <span class="tok-kw">try</span> mem.concat(alloc, []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, &amp;.{ cmd_groups, &amp;.{ init_config.help_group_name } })</span>
<span class="line" id="L1659">                            <span class="tok-kw">else</span> <span class="tok-kw">try</span> alloc.dupe([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, &amp;.{ init_config.help_group_name });</span>
<span class="line" id="L1660">                        <span class="tok-kw">break</span> :add <span class="tok-null">true</span>;</span>
<span class="line" id="L1661">                    },</span>
<span class="line" id="L1662">                    .DoNotAdd =&gt; <span class="tok-null">false</span>,</span>
<span class="line" id="L1663">                };</span>
<span class="line" id="L1664"></span>
<span class="line" id="L1665">                <span class="tok-kw">const</span> help_sub_cmds = [<span class="tok-number">2</span>]<span class="tok-builtin">@This</span>(){</span>
<span class="line" id="L1666">                    .{</span>
<span class="line" id="L1667">                        .name = <span class="tok-str">&quot;usage&quot;</span>,</span>
<span class="line" id="L1668">                        .cmd_group = <span class="tok-kw">if</span> (add_cmd_help_group) init_config.help_group_name <span class="tok-kw">else</span> <span class="tok-null">null</span>, </span>
<span class="line" id="L1669">                        .help_prefix = init_cmd.name,</span>
<span class="line" id="L1670">                        .description = usage_description,</span>
<span class="line" id="L1671">                        .parent_cmd = init_cmd,</span>
<span class="line" id="L1672">                        ._alloc = alloc,</span>
<span class="line" id="L1673">                    },</span>
<span class="line" id="L1674">                    .{</span>
<span class="line" id="L1675">                        .name = <span class="tok-str">&quot;help&quot;</span>,</span>
<span class="line" id="L1676">                        .cmd_group = <span class="tok-kw">if</span> (add_cmd_help_group) init_config.help_group_name <span class="tok-kw">else</span> <span class="tok-null">null</span>, </span>
<span class="line" id="L1677">                        .help_prefix = init_cmd.name,</span>
<span class="line" id="L1678">                        .description = help_description,</span>
<span class="line" id="L1679">                        .parent_cmd = init_cmd,</span>
<span class="line" id="L1680">                        ._alloc = alloc,</span>
<span class="line" id="L1681">                    }</span>
<span class="line" id="L1682">                };</span>
<span class="line" id="L1683"></span>
<span class="line" id="L1684">                init_cmd.sub_cmds = </span>
<span class="line" id="L1685">                    <span class="tok-kw">if</span> (init_cmd.sub_cmds != <span class="tok-null">null</span>) <span class="tok-kw">try</span> mem.concat(alloc, <span class="tok-builtin">@This</span>(), &amp;.{ init_cmd.sub_cmds.?, help_sub_cmds[<span class="tok-number">0</span>..] })</span>
<span class="line" id="L1686">                    <span class="tok-kw">else</span> <span class="tok-kw">try</span> alloc.dupe(<span class="tok-builtin">@This</span>(), help_sub_cmds[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L1687">            }</span>
<span class="line" id="L1688"></span>
<span class="line" id="L1689">            <span class="tok-kw">if</span> (init_config.init_subcmds) addSubCmds: {</span>
<span class="line" id="L1690">                <span class="tok-kw">const</span> sub_cmds = <span class="tok-kw">if</span> (self.sub_cmds) |s_cmds| s_cmds <span class="tok-kw">else</span> <span class="tok-kw">break</span> :addSubCmds;</span>
<span class="line" id="L1691">                <span class="tok-kw">const</span> sub_len = init_cmd.sub_cmds.?.len;</span>
<span class="line" id="L1692">                <span class="tok-kw">var</span> init_subcmds = <span class="tok-kw">try</span> alloc.alloc(<span class="tok-builtin">@This</span>(), sub_len);</span>
<span class="line" id="L1693">                <span class="tok-kw">inline</span> <span class="tok-kw">for</span> (sub_cmds, <span class="tok-number">0</span>..) |cmd, idx| init_subcmds[idx] = <span class="tok-kw">try</span> cmd.initCtx(init_config, <span class="tok-null">false</span>, init_cmd, alloc); </span>
<span class="line" id="L1694">                <span class="tok-kw">if</span> (init_config.add_help_cmds <span class="tok-kw">and</span> (utils.indexOfEql([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, &amp;.{ <span class="tok-str">&quot;help&quot;</span>, <span class="tok-str">&quot;usage&quot;</span> }, self.name) == <span class="tok-null">null</span>)) {</span>
<span class="line" id="L1695">                    init_subcmds[sub_len - <span class="tok-number">2</span>] = init_cmd.sub_cmds.?[sub_len - <span class="tok-number">2</span>];</span>
<span class="line" id="L1696">                    init_subcmds[sub_len - <span class="tok-number">1</span>] = init_cmd.sub_cmds.?[sub_len - <span class="tok-number">1</span>];</span>
<span class="line" id="L1697">                }</span>
<span class="line" id="L1698">                init_cmd.sub_cmds = init_subcmds;</span>
<span class="line" id="L1699">            }</span>
<span class="line" id="L1700"></span>
<span class="line" id="L1701">            <span class="tok-kw">if</span> (self.opts) |opts| {</span>
<span class="line" id="L1702">                <span class="tok-kw">var</span> init_opts = <span class="tok-kw">try</span> alloc.alloc(<span class="tok-builtin">@This</span>().OptionT, opts.len);</span>
<span class="line" id="L1703">                <span class="tok-kw">inline</span> <span class="tok-kw">for</span> (opts, init_opts[<span class="tok-number">0</span>..]) |opt, *i_opt| {</span>
<span class="line" id="L1704">                    i_opt.* = opt.init(alloc);</span>
<span class="line" id="L1705">                    i_opt.*.parent_cmd = init_cmd;</span>
<span class="line" id="L1706">                    i_opt.*.val.parent_cmd = init_cmd;</span>
<span class="line" id="L1707">                }</span>
<span class="line" id="L1708">                init_cmd.opts = init_opts;</span>
<span class="line" id="L1709">            }</span>
<span class="line" id="L1710"></span>
<span class="line" id="L1711">            <span class="tok-kw">if</span> (init_config.add_help_opts) {</span>
<span class="line" id="L1712">                <span class="tok-kw">const</span> add_opt_help_group = <span class="tok-kw">switch</span> (init_config.add_opt_help_group) {</span>
<span class="line" id="L1713">                    .AddIfOthers =&gt; ifOthers: {</span>
<span class="line" id="L1714">                        <span class="tok-kw">if</span> (init_cmd.opt_groups) |opt_groups| {</span>
<span class="line" id="L1715">                            init_cmd.opt_groups = <span class="tok-kw">try</span> mem.concat(alloc, []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, &amp;.{ opt_groups, &amp;.{ init_config.help_group_name } });</span>
<span class="line" id="L1716">                            <span class="tok-kw">break</span> :ifOthers <span class="tok-null">true</span>;</span>
<span class="line" id="L1717">                        }</span>
<span class="line" id="L1718">                        <span class="tok-kw">break</span> :ifOthers <span class="tok-null">false</span>;</span>
<span class="line" id="L1719">                    },</span>
<span class="line" id="L1720">                    .Add =&gt; add: {</span>
<span class="line" id="L1721">                        init_cmd.opt_groups = </span>
<span class="line" id="L1722">                            <span class="tok-kw">if</span> (init_cmd.opt_groups) |opt_groups| <span class="tok-kw">try</span> mem.concat(alloc, []<span class="tok-kw">const</span> <span class="tok-type">u8</span>, &amp;.{ opt_groups, &amp;.{ init_config.help_group_name } })</span>
<span class="line" id="L1723">                            <span class="tok-kw">else</span> <span class="tok-kw">try</span> alloc.dupe([]<span class="tok-kw">const</span> <span class="tok-type">u8</span>, &amp;.{ init_config.help_group_name });</span>
<span class="line" id="L1724">                        <span class="tok-kw">break</span> :add <span class="tok-null">true</span>;</span>
<span class="line" id="L1725">                    },</span>
<span class="line" id="L1726">                    .DoNotAdd =&gt; <span class="tok-null">false</span>,</span>
<span class="line" id="L1727">                };</span>
<span class="line" id="L1728">                <span class="tok-kw">var</span> help_opts = [<span class="tok-number">2</span>]OptionT{</span>
<span class="line" id="L1729">                    .{</span>
<span class="line" id="L1730">                        ._alloc = alloc,</span>
<span class="line" id="L1731">                        .opt_group = <span class="tok-kw">if</span> (add_opt_help_group) init_config.help_group_name <span class="tok-kw">else</span> <span class="tok-null">null</span>, </span>
<span class="line" id="L1732">                        .name = <span class="tok-str">&quot;usage&quot;</span>,</span>
<span class="line" id="L1733">                        .short_name = <span class="tok-str">'u'</span>,</span>
<span class="line" id="L1734">                        .long_name = <span class="tok-str">&quot;usage&quot;</span>,</span>
<span class="line" id="L1735">                        .description = usage_description,</span>
<span class="line" id="L1736">                        .parent_cmd = init_cmd,</span>
<span class="line" id="L1737">                        .val = ValueT.ofType(<span class="tok-type">bool</span>, .{ .name = <span class="tok-str">&quot;usage_flag&quot;</span> }),</span>
<span class="line" id="L1738">                    },</span>
<span class="line" id="L1739">                    .{</span>
<span class="line" id="L1740">                        ._alloc = alloc,</span>
<span class="line" id="L1741">                        .opt_group = <span class="tok-kw">if</span> (add_opt_help_group) init_config.help_group_name <span class="tok-kw">else</span> <span class="tok-null">null</span>, </span>
<span class="line" id="L1742">                        .name = <span class="tok-str">&quot;help&quot;</span>,</span>
<span class="line" id="L1743">                        .short_name = <span class="tok-str">'h'</span>,</span>
<span class="line" id="L1744">                        .long_name = <span class="tok-str">&quot;help&quot;</span>,</span>
<span class="line" id="L1745">                        .description = help_description,</span>
<span class="line" id="L1746">                        .parent_cmd = init_cmd,</span>
<span class="line" id="L1747">                        .val = ValueT.ofType(<span class="tok-type">bool</span>, .{ .name = <span class="tok-str">&quot;help_flag&quot;</span> }),</span>
<span class="line" id="L1748">                    },</span>
<span class="line" id="L1749">                };</span>
<span class="line" id="L1750">                <span class="tok-kw">for</span> (help_opts[<span class="tok-number">0</span>..]) |*opt| opt.* = opt.init(alloc);</span>
<span class="line" id="L1751"></span>
<span class="line" id="L1752">                init_cmd.opts = </span>
<span class="line" id="L1753">                    <span class="tok-kw">if</span> (init_cmd.opts) |init_opts| <span class="tok-kw">try</span> mem.concat(alloc, <span class="tok-builtin">@This</span>().OptionT, &amp;.{ init_opts, help_opts[<span class="tok-number">0</span>..] })</span>
<span class="line" id="L1754">                    <span class="tok-kw">else</span> <span class="tok-kw">try</span> alloc.dupe(OptionT, help_opts[<span class="tok-number">0</span>..]);</span>
<span class="line" id="L1755">            }</span>
<span class="line" id="L1756"></span>
<span class="line" id="L1757">            <span class="tok-kw">if</span> (self.vals) |vals| {</span>
<span class="line" id="L1758">                <span class="tok-kw">var</span> init_vals = <span class="tok-kw">try</span> alloc.alloc(<span class="tok-builtin">@This</span>().ValueT, vals.len);</span>
<span class="line" id="L1759">                <span class="tok-kw">inline</span> <span class="tok-kw">for</span> (vals, init_vals[<span class="tok-number">0</span>..]) |val, *i_val| {</span>
<span class="line" id="L1760">                    i_val.* = val.init(alloc);</span>
<span class="line" id="L1761">                    i_val.*.parent_cmd = init_cmd;</span>
<span class="line" id="L1762">                }</span>
<span class="line" id="L1763">                init_cmd.vals = init_vals;</span>
<span class="line" id="L1764">            }</span>
<span class="line" id="L1765"></span>
<span class="line" id="L1766">            <span class="tok-kw">return</span> <span class="tok-kw">if</span> (is_root_cmd) init_cmd <span class="tok-kw">else</span> init_cmd.*;</span>
<span class="line" id="L1767">        }</span>
<span class="line" id="L1768"></span>
<span class="line" id="L1769">        <span class="tok-comment">/// De-initialize the Root Command with its Arena Allocator.</span></span>
<span class="line" id="L1770">        <span class="tok-comment">/// If this Command has not yet been initialized or is not the Root Command, this does nothing.</span></span>
<span class="line" id="L1771">        <span class="tok-kw">pub</span> <span class="tok-kw">fn</span> <span class="tok-fn">deinit</span>(self: *<span class="tok-kw">const</span> <span class="tok-builtin">@This</span>()) <span class="tok-type">void</span> {</span>
<span class="line" id="L1772">            <span class="tok-kw">if</span> (self._arena) |arena| arena.deinit();</span>
<span class="line" id="L1773">            <span class="tok-kw">if</span> (self._root_alloc) |root_alloc| root_alloc.destroy(self);</span>
<span class="line" id="L1774">        }</span>
<span class="line" id="L1775">    };</span>
<span class="line" id="L1776">}</span>
<span class="line" id="L1777"></span>
<span class="line" id="L1778"></span>
</code></pre></body>
</html>